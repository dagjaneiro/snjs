{"code":"import * as tslib_1 from \"tslib\";\r\nimport find from 'lodash/find';\r\nimport pull from 'lodash/pull';\r\nimport remove from 'lodash/remove';\r\nimport uniq from 'lodash/uniq';\r\nimport { StandardFile } from 'standard-file-js/lib/standard_file';\r\nimport { SFModelManager } from 'standard-file-js/lib/app/lib/modelManager';\r\nvar SNComponentManager = /** @class */ (function () {\r\n    /*\r\n      @param {string} environment: one of [web, desktop, mobile]\r\n      @param {string} platform: one of [ios, android, linux-${environment}, mac-${environment}, windows-${environment}]\r\n    */\r\n    function SNComponentManager(_a) {\r\n        var modelManager = _a.modelManager, syncManager = _a.syncManager, desktopManager = _a.desktopManager, nativeExtManager = _a.nativeExtManager, alertManager = _a.alertManager, $uiRunner = _a.$uiRunner, $timeout = _a.$timeout, environment = _a.environment, platform = _a.platform;\r\n        // Some actions need to be run on the ui thread (desktop/web only)\r\n        this.$uiRunner =\r\n            $uiRunner ||\r\n                (function (fn) {\r\n                    fn();\r\n                });\r\n        this.$timeout = $timeout || setTimeout.bind(window);\r\n        this.modelManager = modelManager;\r\n        this.syncManager = syncManager;\r\n        this.desktopManager = desktopManager;\r\n        this.nativeExtManager = nativeExtManager;\r\n        this.alertManager = alertManager;\r\n        this.streamObservers = [];\r\n        this.contextStreamObservers = [];\r\n        this.activeComponents = [];\r\n        this.environment = environment;\r\n        this.platform = platform;\r\n        this.isDesktop = this.environment == 'desktop';\r\n        this.isMobile = this.environment == 'mobile';\r\n        this.SFJS = new StandardFile();\r\n        if (environment != 'mobile') {\r\n            this.configureForNonMobileUsage();\r\n        }\r\n        this.configureForGeneralUsage();\r\n        // this.loggingEnabled = true;\r\n        this.permissionDialogs = [];\r\n        this.handlers = [];\r\n    }\r\n    SNComponentManager.prototype.configureForGeneralUsage = function () {\r\n        var _this = this;\r\n        this.modelManager.addItemSyncObserver('component-manager', '*', function (allItems, validItems, deletedItems, source, sourceKey) {\r\n            var syncedComponents = allItems.filter(function (item) {\r\n                return (item.content_type === 'SN|Component' ||\r\n                    item.content_type == 'SN|Theme');\r\n            });\r\n            /* We only want to sync if the item source is Retrieved, not MappingSourceRemoteSaved to avoid\r\n            recursion caused by the component being modified and saved after it is updated.\r\n          */\r\n            if (syncedComponents.length > 0 &&\r\n                source != SFModelManager.MappingSourceRemoteSaved) {\r\n                // Ensure any component in our data is installed by the system\r\n                if (_this.isDesktop) {\r\n                    _this.desktopManager.syncComponentsInstallation(syncedComponents);\r\n                }\r\n            }\r\n            for (var _i = 0, syncedComponents_1 = syncedComponents; _i < syncedComponents_1.length; _i++) {\r\n                var component = syncedComponents_1[_i];\r\n                var activeComponent = find(_this.activeComponents, {\r\n                    uuid: component.uuid\r\n                });\r\n                if (component.active && !component.deleted && !activeComponent) {\r\n                    _this.activateComponent(component);\r\n                }\r\n                else if (!component.active && activeComponent) {\r\n                    _this.deactivateComponent(component);\r\n                }\r\n            }\r\n            var _loop_1 = function (observer) {\r\n                if (sourceKey && sourceKey == observer.component.uuid) {\r\n                    return \"continue\";\r\n                }\r\n                var relevantItems = allItems.filter(function (item) {\r\n                    return observer.contentTypes.indexOf(item.content_type) !== -1;\r\n                });\r\n                if (relevantItems.length == 0) {\r\n                    return \"continue\";\r\n                }\r\n                var requiredPermissions = [\r\n                    {\r\n                        name: 'stream-items',\r\n                        content_types: observer.contentTypes.sort()\r\n                    }\r\n                ];\r\n                _this.runWithPermissions(observer.component, requiredPermissions, function () {\r\n                    _this.sendItemsInReply(observer.component, relevantItems, observer.originalMessage);\r\n                });\r\n            };\r\n            for (var _a = 0, _b = _this.streamObservers; _a < _b.length; _a++) {\r\n                var observer = _b[_a];\r\n                _loop_1(observer);\r\n            }\r\n            var requiredContextPermissions = [\r\n                {\r\n                    name: 'stream-context-item'\r\n                }\r\n            ];\r\n            var _loop_2 = function (observer) {\r\n                if (sourceKey && sourceKey == observer.component.uuid) {\r\n                    return \"continue\";\r\n                }\r\n                for (var _i = 0, _a = _this.handlers; _i < _a.length; _i++) {\r\n                    var handler = _a[_i];\r\n                    if (!handler.areas.includes(observer.component.area) &&\r\n                        !handler.areas.includes('*')) {\r\n                        continue;\r\n                    }\r\n                    if (handler.contextRequestHandler) {\r\n                        itemInContext = handler.contextRequestHandler(observer.component);\r\n                        if (itemInContext) {\r\n                            matchingItem = find(allItems, {\r\n                                uuid: itemInContext.uuid\r\n                            });\r\n                            if (matchingItem) {\r\n                                _this.runWithPermissions(observer.component, requiredContextPermissions, function () {\r\n                                    _this.sendContextItemInReply(observer.component, matchingItem, observer.originalMessage, source);\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var itemInContext, matchingItem;\r\n            for (var _c = 0, _d = _this.contextStreamObservers; _c < _d.length; _c++) {\r\n                var observer = _d[_c];\r\n                _loop_2(observer);\r\n            }\r\n        });\r\n    };\r\n    SNComponentManager.prototype.configureForNonMobileUsage = function () {\r\n        var _this = this;\r\n        var detectFocusChange = function (event) {\r\n            for (var _i = 0, _a = _this.activeComponents; _i < _a.length; _i++) {\r\n                var component = _a[_i];\r\n                if (document.activeElement == _this.iframeForComponent(component)) {\r\n                    _this.$timeout(function () {\r\n                        _this.focusChangedForComponent(component);\r\n                    });\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n        window.addEventListener\r\n            ? window.addEventListener('focus', detectFocusChange, true)\r\n            : window.attachEvent('onfocusout', detectFocusChange);\r\n        window.addEventListener\r\n            ? window.addEventListener('blur', detectFocusChange, true)\r\n            : window.attachEvent('onblur', detectFocusChange);\r\n        this.desktopManager.registerUpdateObserver(function (component) {\r\n            // Reload theme if active\r\n            if (component.active && component.isTheme()) {\r\n                _this.postActiveThemesToAllComponents();\r\n            }\r\n        });\r\n        // On mobile, events listeners are handled by a respective component\r\n        window.addEventListener('message', function (event) {\r\n            if (_this.loggingEnabled) {\r\n                console.log('Web app: received message', event);\r\n            }\r\n            // Make sure this message is for us\r\n            if (event.data.sessionKey) {\r\n                _this.handleMessage(_this.componentForSessionKey(event.data.sessionKey), event.data);\r\n            }\r\n        }, false);\r\n    };\r\n    SNComponentManager.prototype.postActiveThemesToAllComponents = function () {\r\n        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {\r\n            var component = _a[_i];\r\n            // Skip over components that are themes themselves,\r\n            // or components that are not active, or components that don't have a window\r\n            if (component.isTheme() || !component.active || !component.window) {\r\n                continue;\r\n            }\r\n            this.postActiveThemesToComponent(component);\r\n        }\r\n    };\r\n    SNComponentManager.prototype.getActiveThemes = function () {\r\n        return this.componentsForArea('themes').filter(function (theme) {\r\n            return theme.active;\r\n        });\r\n    };\r\n    SNComponentManager.prototype.urlsForActiveThemes = function () {\r\n        var _this = this;\r\n        var themes = this.getActiveThemes();\r\n        return themes.map(function (theme) {\r\n            return _this.urlForComponent(theme);\r\n        });\r\n    };\r\n    SNComponentManager.prototype.postActiveThemesToComponent = function (component) {\r\n        var urls = this.urlsForActiveThemes();\r\n        var data = { themes: urls };\r\n        this.sendMessageToComponent(component, { action: 'themes', data: data });\r\n    };\r\n    SNComponentManager.prototype.contextItemDidChangeInArea = function (area) {\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            if (handler.areas.includes(area) === false &&\r\n                !handler.areas.includes('*')) {\r\n                continue;\r\n            }\r\n            var observers = this.contextStreamObservers.filter(function (observer) {\r\n                return observer.component.area === area;\r\n            });\r\n            for (var _b = 0, observers_1 = observers; _b < observers_1.length; _b++) {\r\n                var observer = observers_1[_b];\r\n                if (handler.contextRequestHandler) {\r\n                    var itemInContext = handler.contextRequestHandler(observer.component);\r\n                    if (itemInContext) {\r\n                        this.sendContextItemInReply(observer.component, itemInContext, observer.originalMessage);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.setComponentHidden = function (component, hidden) {\r\n        /*\r\n          A hidden component will not receive messages.\r\n          However, when a component is unhidden, we need to send it any items it may have\r\n          registered streaming for.\r\n        */\r\n        if (hidden) {\r\n            component.hidden = true;\r\n        }\r\n        else if (component.hidden) {\r\n            // Only enter this condition if component is hidden to make this note have double side effects.\r\n            component.hidden = false;\r\n            // streamContextItem\r\n            var contextObserver = find(this.contextStreamObservers, {\r\n                identifier: component.uuid\r\n            });\r\n            if (contextObserver) {\r\n                this.handleStreamContextItemMessage(component, contextObserver.originalMessage);\r\n            }\r\n            // streamItems\r\n            var streamObserver = find(this.streamObservers, {\r\n                identifier: component.uuid\r\n            });\r\n            if (streamObserver) {\r\n                this.handleStreamItemsMessage(component, streamObserver.originalMessage);\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.jsonForItem = function (item, component, source) {\r\n        var params = {\r\n            uuid: item.uuid,\r\n            content_type: item.content_type,\r\n            created_at: item.created_at,\r\n            updated_at: item.updated_at,\r\n            deleted: item.deleted\r\n        };\r\n        params.content = item.createContentJSONFromProperties();\r\n        params.clientData =\r\n            item.getDomainDataItem(component.getClientDataKey(), SNComponentManager.ClientDataDomain) || {};\r\n        // isMetadataUpdate implies that the extension should make reference of updated metadata,\r\n        // but not update content values as they may be stale relative to what the extension currently has\r\n        // Changes are always metadata updates if the mapping source is SFModelManager.MappingSourceRemoteSaved || source == SFModelManager.MappingSourceLocalSaved.\r\n        //\r\n        if (source &&\r\n            (source == SFModelManager.MappingSourceRemoteSaved ||\r\n                source == SFModelManager.MappingSourceLocalSaved)) {\r\n            params.isMetadataUpdate = true;\r\n        }\r\n        this.removePrivatePropertiesFromResponseItems([params], component, {\r\n            type: 'outgoing'\r\n        });\r\n        return params;\r\n    };\r\n    SNComponentManager.prototype.sendItemsInReply = function (component, items, message, source) {\r\n        var _this = this;\r\n        if (this.loggingEnabled) {\r\n            console.log('Web|componentManager|sendItemsInReply', component, items, message);\r\n        }\r\n        var response = { items: {} };\r\n        var mapped = items.map(function (item) {\r\n            return _this.jsonForItem(item, component, source);\r\n        });\r\n        response.items = mapped;\r\n        this.replyToMessage(component, message, response);\r\n    };\r\n    SNComponentManager.prototype.sendContextItemInReply = function (component, item, originalMessage, source) {\r\n        if (this.loggingEnabled) {\r\n            console.log('Web|componentManager|sendContextItemInReply', component, item, originalMessage);\r\n        }\r\n        var response = { item: this.jsonForItem(item, component, source) };\r\n        this.replyToMessage(component, originalMessage, response);\r\n    };\r\n    SNComponentManager.prototype.replyToMessage = function (component, originalMessage, replyData) {\r\n        var reply = {\r\n            action: 'reply',\r\n            original: originalMessage,\r\n            data: replyData\r\n        };\r\n        this.sendMessageToComponent(component, reply);\r\n    };\r\n    SNComponentManager.prototype.sendMessageToComponent = function (component, message) {\r\n        var permissibleActionsWhileHidden = ['component-registered', 'themes'];\r\n        if (component.hidden &&\r\n            !permissibleActionsWhileHidden.includes(message.action)) {\r\n            if (this.loggingEnabled) {\r\n                console.log('Component disabled for current item, not sending any messages.', component.name);\r\n            }\r\n            return;\r\n        }\r\n        if (this.loggingEnabled) {\r\n            console.log('Web|sendMessageToComponent', component, message);\r\n        }\r\n        var origin = this.urlForComponent(component, 'file://');\r\n        if (!origin.startsWith('http') && !origin.startsWith('file')) {\r\n            // Native extension running in web, prefix current host\r\n            origin = window.location.href + origin;\r\n        }\r\n        if (!component.window) {\r\n            this.alertManager.alert({\r\n                text: \"Standard Notes is trying to communicate with \" + component.name + \", but an error is occurring. Please restart this extension and try again.\"\r\n            });\r\n        }\r\n        // Mobile messaging requires json\r\n        if (this.isMobile) {\r\n            message = JSON.stringify(message);\r\n        }\r\n        component.window.postMessage(message, origin);\r\n    };\r\n    Object.defineProperty(SNComponentManager.prototype, \"components\", {\r\n        get: function () {\r\n            return this.modelManager.allItemsMatchingTypes([\r\n                'SN|Component',\r\n                'SN|Theme'\r\n            ]);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SNComponentManager.prototype.componentsForArea = function (area) {\r\n        return this.components.filter(function (component) {\r\n            return component.area === area;\r\n        });\r\n    };\r\n    SNComponentManager.prototype.urlForComponent = function (component, offlinePrefix) {\r\n        if (offlinePrefix === void 0) { offlinePrefix = ''; }\r\n        // offlineOnly is available only on desktop, and not on web or mobile.\r\n        if (component.offlineOnly && !this.isDesktop) {\r\n            return null;\r\n        }\r\n        if (component.offlineOnly || (this.isDesktop && component.local_url)) {\r\n            return (component.local_url &&\r\n                component.local_url.replace('sn://', offlinePrefix + this.desktopManager.getApplicationDataPath() + '/'));\r\n        }\r\n        else {\r\n            var url = component.hosted_url || component.legacy_url;\r\n            if (this.isMobile) {\r\n                var localReplacement = this.platform == 'ios' ? 'localhost' : '10.0.2.2';\r\n                url = url\r\n                    .replace('localhost', localReplacement)\r\n                    .replace('sn.local', localReplacement);\r\n            }\r\n            return url;\r\n        }\r\n    };\r\n    SNComponentManager.prototype.componentForUrl = function (url) {\r\n        return this.components.filter(function (component) {\r\n            return component.hosted_url === url || component.legacy_url === url;\r\n        })[0];\r\n    };\r\n    SNComponentManager.prototype.componentForSessionKey = function (key) {\r\n        var component = find(this.components, { sessionKey: key });\r\n        if (!component) {\r\n            for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n                var handler = _a[_i];\r\n                if (handler.componentForSessionKeyHandler) {\r\n                    component = handler.componentForSessionKeyHandler(key);\r\n                    if (component) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return component;\r\n    };\r\n    SNComponentManager.prototype.handleMessage = function (component, message) {\r\n        if (!component) {\r\n            console.log('Component not defined for message, returning', message);\r\n            this.alertManager.alert({\r\n                text: 'An extension is trying to communicate with Standard Notes, but there is an error establishing a bridge. Please restart the app and try again.'\r\n            });\r\n            return;\r\n        }\r\n        // Actions that won't succeeed with readonly mode\r\n        var readwriteActions = [\r\n            'save-items',\r\n            'associate-item',\r\n            'deassociate-item',\r\n            'create-item',\r\n            'create-items',\r\n            'delete-items',\r\n            'set-component-data'\r\n        ];\r\n        if (component.readonly && readwriteActions.includes(message.action)) {\r\n            // A component can be marked readonly if changes should not be saved.\r\n            // Particullary used for revision preview windows where the notes should not be savable.\r\n            this.alertManager.alert({\r\n                text: \"The extension \" + component.name + \" is trying to save, but it is in a locked state and cannot accept changes.\"\r\n            });\r\n            return;\r\n        }\r\n        /**\r\n        Possible Messages:\r\n          set-size\r\n          stream-items\r\n          stream-context-item\r\n          save-items\r\n          select-item\r\n          associate-item\r\n          deassociate-item\r\n          clear-selection\r\n          create-item\r\n          create-items\r\n          delete-items\r\n          set-component-data\r\n          install-local-component\r\n          toggle-activate-component\r\n          request-permissions\r\n          present-conflict-resolution\r\n        */\r\n        if (message.action === 'stream-items') {\r\n            this.handleStreamItemsMessage(component, message);\r\n        }\r\n        else if (message.action === 'stream-context-item') {\r\n            this.handleStreamContextItemMessage(component, message);\r\n        }\r\n        else if (message.action === 'set-component-data') {\r\n            this.handleSetComponentDataMessage(component, message);\r\n        }\r\n        else if (message.action === 'delete-items') {\r\n            this.handleDeleteItemsMessage(component, message);\r\n        }\r\n        else if (message.action === 'create-items' ||\r\n            message.action === 'create-item') {\r\n            this.handleCreateItemsMessage(component, message);\r\n        }\r\n        else if (message.action === 'save-items') {\r\n            this.handleSaveItemsMessage(component, message);\r\n        }\r\n        else if (message.action === 'toggle-activate-component') {\r\n            var componentToToggle = this.modelManager.findItem(message.data.uuid);\r\n            this.handleToggleComponentMessage(component, componentToToggle, message);\r\n        }\r\n        else if (message.action === 'request-permissions') {\r\n            this.handleRequestPermissionsMessage(component, message);\r\n        }\r\n        else if (message.action === 'install-local-component') {\r\n            this.handleInstallLocalComponentMessage(component, message);\r\n        }\r\n        else if (message.action === 'duplicate-item') {\r\n            this.handleDuplicateItemMessage(component, message);\r\n        }\r\n        var _loop_3 = function (handler) {\r\n            if (handler.actionHandler &&\r\n                (handler.areas.includes(component.area) || handler.areas.includes('*'))) {\r\n                this_1.$timeout(function () {\r\n                    handler.actionHandler(component, message.action, message.data);\r\n                });\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        // Notify observers\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            _loop_3(handler);\r\n        }\r\n    };\r\n    SNComponentManager.prototype.removePrivatePropertiesFromResponseItems = function (responseItems, component, options) {\r\n        if (options === void 0) { options = {}; }\r\n        // can be 'incoming' or 'outgoing'. We want to remove updated_at if incoming, but keep it if outgoing\r\n        if (options.type == 'incoming') {\r\n            var privateTopLevelProperties = ['updated_at'];\r\n            // Maintaining our own updated_at value is imperative for sync to work properly, we ignore any incoming value.\r\n            for (var _i = 0, responseItems_1 = responseItems; _i < responseItems_1.length; _i++) {\r\n                var responseItem = responseItems_1[_i];\r\n                if (typeof responseItem.setDirty === 'function') {\r\n                    console.error('Attempting to pass object. Use JSON.');\r\n                    continue;\r\n                }\r\n                for (var _a = 0, privateTopLevelProperties_1 = privateTopLevelProperties; _a < privateTopLevelProperties_1.length; _a++) {\r\n                    var privateProperty = privateTopLevelProperties_1[_a];\r\n                    delete responseItem[privateProperty];\r\n                }\r\n            }\r\n        }\r\n        if (component) {\r\n            // System extensions can bypass this step\r\n            if (this.nativeExtManager &&\r\n                this.nativeExtManager.isSystemExtension(component)) {\r\n                return;\r\n            }\r\n        }\r\n        // Don't allow component to overwrite these properties.\r\n        var privateContentProperties = [\r\n            'autoupdateDisabled',\r\n            'permissions',\r\n            'active'\r\n        ];\r\n        if (options) {\r\n            if (options.includeUrls) {\r\n                privateContentProperties = privateContentProperties.concat([\r\n                    'url',\r\n                    'hosted_url',\r\n                    'local_url'\r\n                ]);\r\n            }\r\n        }\r\n        for (var _b = 0, responseItems_2 = responseItems; _b < responseItems_2.length; _b++) {\r\n            var responseItem = responseItems_2[_b];\r\n            // Do not pass in actual items here, otherwise that would be destructive.\r\n            // Instead, generic JS/JSON objects should be passed.\r\n            if (typeof responseItem.setDirty === 'function') {\r\n                console.error('Attempting to pass object. Use JSON.');\r\n                continue;\r\n            }\r\n            for (var _c = 0, privateContentProperties_1 = privateContentProperties; _c < privateContentProperties_1.length; _c++) {\r\n                var prop = privateContentProperties_1[_c];\r\n                delete responseItem.content[prop];\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.handleStreamItemsMessage = function (component, message) {\r\n        var _this = this;\r\n        var requiredPermissions = [\r\n            {\r\n                name: 'stream-items',\r\n                content_types: message.data.content_types.sort()\r\n            }\r\n        ];\r\n        this.runWithPermissions(component, requiredPermissions, function () {\r\n            if (!find(_this.streamObservers, { identifier: component.uuid })) {\r\n                // for pushing laster as changes come in\r\n                _this.streamObservers.push({\r\n                    identifier: component.uuid,\r\n                    component: component,\r\n                    originalMessage: message,\r\n                    contentTypes: message.data.content_types\r\n                });\r\n            }\r\n            // push immediately now\r\n            var items = [];\r\n            for (var _i = 0, _a = message.data.content_types; _i < _a.length; _i++) {\r\n                var contentType = _a[_i];\r\n                items = items.concat(_this.modelManager.validItemsForContentType(contentType));\r\n            }\r\n            _this.sendItemsInReply(component, items, message);\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleStreamContextItemMessage = function (component, message) {\r\n        var _this = this;\r\n        var requiredPermissions = [\r\n            {\r\n                name: 'stream-context-item'\r\n            }\r\n        ];\r\n        this.runWithPermissions(component, requiredPermissions, function () {\r\n            if (!find(_this.contextStreamObservers, { identifier: component.uuid })) {\r\n                // for pushing laster as changes come in\r\n                _this.contextStreamObservers.push({\r\n                    identifier: component.uuid,\r\n                    component: component,\r\n                    originalMessage: message\r\n                });\r\n            }\r\n            // push immediately now\r\n            for (var _i = 0, _a = _this.handlersForArea(component.area); _i < _a.length; _i++) {\r\n                var handler = _a[_i];\r\n                if (handler.contextRequestHandler) {\r\n                    var itemInContext = handler.contextRequestHandler(component);\r\n                    if (itemInContext) {\r\n                        _this.sendContextItemInReply(component, itemInContext, message);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    };\r\n    SNComponentManager.prototype.isItemIdWithinComponentContextJurisdiction = function (uuid, component) {\r\n        var itemIdsInJurisdiction = this.itemIdsInContextJurisdictionForComponent(component);\r\n        return itemIdsInJurisdiction.includes(uuid);\r\n    };\r\n    /* Returns items that given component has context permissions for */\r\n    SNComponentManager.prototype.itemIdsInContextJurisdictionForComponent = function (component) {\r\n        var itemIds = [];\r\n        for (var _i = 0, _a = this.handlersForArea(component.area); _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            if (handler.contextRequestHandler) {\r\n                var itemInContext = handler.contextRequestHandler(component);\r\n                if (itemInContext) {\r\n                    itemIds.push(itemInContext.uuid);\r\n                }\r\n            }\r\n        }\r\n        return itemIds;\r\n    };\r\n    SNComponentManager.prototype.handlersForArea = function (area) {\r\n        return this.handlers.filter(function (candidate) {\r\n            return candidate.areas.includes(area);\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleSaveItemsMessage = function (component, message) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var responseItems, requiredPermissions, itemIdsInContextJurisdiction, pendingResponseItems, _i, _a, responseItem, requiredContentTypes;\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                responseItems = message.data.items;\r\n                requiredPermissions = [];\r\n                itemIdsInContextJurisdiction = this.itemIdsInContextJurisdictionForComponent(component);\r\n                pendingResponseItems = responseItems.slice();\r\n                for (_i = 0, _a = responseItems.slice(); _i < _a.length; _i++) {\r\n                    responseItem = _a[_i];\r\n                    if (itemIdsInContextJurisdiction.includes(responseItem.uuid)) {\r\n                        requiredPermissions.push({\r\n                            name: 'stream-context-item'\r\n                        });\r\n                        pull(pendingResponseItems, responseItem);\r\n                        // We break because there can only be one context item\r\n                        break;\r\n                    }\r\n                }\r\n                // Check to see if additional privileges are required\r\n                if (pendingResponseItems.length > 0) {\r\n                    requiredContentTypes = uniq(pendingResponseItems.map(function (i) {\r\n                        return i.content_type;\r\n                    })).sort();\r\n                    requiredPermissions.push({\r\n                        name: 'stream-items',\r\n                        content_types: requiredContentTypes\r\n                    });\r\n                }\r\n                this.runWithPermissions(component, requiredPermissions, function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n                    var ids, items, lockedCount, _i, items_1, item, itemNoun, auxVerb, localItems, _a, responseItems_3, responseItem, item;\r\n                    var _this = this;\r\n                    return tslib_1.__generator(this, function (_b) {\r\n                        switch (_b.label) {\r\n                            case 0:\r\n                                this.removePrivatePropertiesFromResponseItems(responseItems, component, {\r\n                                    includeUrls: true,\r\n                                    type: 'incoming'\r\n                                });\r\n                                ids = responseItems.map(function (i) {\r\n                                    return i.uuid;\r\n                                });\r\n                                items = this.modelManager.findItems(ids);\r\n                                lockedCount = 0;\r\n                                for (_i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                                    item = items_1[_i];\r\n                                    if (item.locked) {\r\n                                        remove(responseItems, { uuid: item.uuid });\r\n                                        lockedCount++;\r\n                                    }\r\n                                }\r\n                                if (lockedCount > 0) {\r\n                                    itemNoun = lockedCount == 1 ? 'item' : 'items';\r\n                                    auxVerb = lockedCount == 1 ? 'is' : 'are';\r\n                                    this.alertManager.alert({\r\n                                        title: 'Items Locked',\r\n                                        text: lockedCount + \" \" + itemNoun + \" you are attempting to save \" + auxVerb + \" locked and cannot be edited.\"\r\n                                    });\r\n                                }\r\n                                return [4 /*yield*/, this.modelManager.mapResponseItemsToLocalModels(responseItems, SFModelManager.MappingSourceComponentRetrieved, component.uuid)];\r\n                            case 1:\r\n                                localItems = _b.sent();\r\n                                for (_a = 0, responseItems_3 = responseItems; _a < responseItems_3.length; _a++) {\r\n                                    responseItem = responseItems_3[_a];\r\n                                    item = find(localItems, { uuid: responseItem.uuid });\r\n                                    if (!item) {\r\n                                        // An item this extension is trying to save was possibly removed locally, notify user\r\n                                        this.alertManager.alert({\r\n                                            text: \"The extension \" + component.name + \" is trying to save an item with type \" + responseItem.content_type + \", but that item does not exist. Please restart this extension and try again.\"\r\n                                        });\r\n                                        continue;\r\n                                    }\r\n                                    if (!item.locked) {\r\n                                        if (responseItem.clientData) {\r\n                                            item.setDomainDataItem(component.getClientDataKey(), responseItem.clientData, SNComponentManager.ClientDataDomain);\r\n                                        }\r\n                                        this.modelManager.setItemDirty(item, true, true, SFModelManager.MappingSourceComponentRetrieved, component.uuid);\r\n                                    }\r\n                                }\r\n                                this.syncManager.sync().then(function (response) {\r\n                                    // Allow handlers to be notified when a save begins and ends, to update the UI\r\n                                    var saveMessage = Object.assign({}, message);\r\n                                    saveMessage.action =\r\n                                        response && response.error ? 'save-error' : 'save-success';\r\n                                    _this.replyToMessage(component, message, {\r\n                                        error: response && response.error\r\n                                    });\r\n                                    _this.handleMessage(component, saveMessage);\r\n                                });\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                }); });\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleDuplicateItemMessage = function (component, message) {\r\n        var _this = this;\r\n        var itemParams = message.data.item;\r\n        var item = this.modelManager.findItem(itemParams.uuid);\r\n        var requiredPermissions = [\r\n            {\r\n                name: 'stream-items',\r\n                content_types: [item.content_type]\r\n            }\r\n        ];\r\n        this.runWithPermissions(component, requiredPermissions, function () {\r\n            var duplicate = _this.modelManager.duplicateItemAndAdd(item);\r\n            _this.syncManager.sync();\r\n            _this.replyToMessage(component, message, {\r\n                item: _this.jsonForItem(duplicate, component)\r\n            });\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleCreateItemsMessage = function (component, message) {\r\n        var _this = this;\r\n        var responseItems = message.data.item\r\n            ? [message.data.item]\r\n            : message.data.items;\r\n        var uniqueContentTypes = uniq(responseItems.map(function (item) {\r\n            return item.content_type;\r\n        }));\r\n        var requiredPermissions = [\r\n            {\r\n                name: 'stream-items',\r\n                content_types: uniqueContentTypes\r\n            }\r\n        ];\r\n        this.runWithPermissions(component, requiredPermissions, function () {\r\n            _this.removePrivatePropertiesFromResponseItems(responseItems, component, {\r\n                type: 'incoming'\r\n            });\r\n            var processedItems = [];\r\n            for (var _i = 0, responseItems_4 = responseItems; _i < responseItems_4.length; _i++) {\r\n                var responseItem = responseItems_4[_i];\r\n                var item = _this.modelManager.createItem(responseItem);\r\n                if (responseItem.clientData) {\r\n                    item.setDomainDataItem(component.getClientDataKey(), responseItem.clientData, SNComponentManager.ClientDataDomain);\r\n                }\r\n                _this.modelManager.addItem(item);\r\n                _this.modelManager.resolveReferencesForItem(item, true);\r\n                _this.modelManager.setItemDirty(item, true);\r\n                processedItems.push(item);\r\n            }\r\n            _this.syncManager.sync();\r\n            // \"create-item\" or \"create-items\" are possible messages handled here\r\n            var reply = message.action == 'create-item'\r\n                ? { item: _this.jsonForItem(processedItems[0], component) }\r\n                : {\r\n                    items: processedItems.map(function (item) {\r\n                        return _this.jsonForItem(item, component);\r\n                    })\r\n                };\r\n            _this.replyToMessage(component, message, reply);\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleDeleteItemsMessage = function (component, message) {\r\n        var _this = this;\r\n        var requiredContentTypes = uniq(message.data.items.map(function (i) {\r\n            return i.content_type;\r\n        })).sort();\r\n        var requiredPermissions = [\r\n            {\r\n                name: 'stream-items',\r\n                content_types: requiredContentTypes\r\n            }\r\n        ];\r\n        this.runWithPermissions(component, requiredPermissions, function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n            var itemsData, noun, reply, didConfirm, _i, itemsData_1, itemData, model;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        itemsData = message.data.items;\r\n                        noun = itemsData.length == 1 ? 'item' : 'items';\r\n                        didConfirm = true;\r\n                        return [4 /*yield*/, this.alertManager\r\n                                .confirm({\r\n                                text: \"Are you sure you want to delete \" + itemsData.length + \" \" + noun + \"?\"\r\n                            })\r\n                                .catch(function () {\r\n                                didConfirm = false;\r\n                            })];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (didConfirm) {\r\n                            // Filter for any components and deactivate before deleting\r\n                            for (_i = 0, itemsData_1 = itemsData; _i < itemsData_1.length; _i++) {\r\n                                itemData = itemsData_1[_i];\r\n                                model = this.modelManager.findItem(itemData.uuid);\r\n                                if (!model) {\r\n                                    this.alertManager.alert({\r\n                                        text: \"The item you are trying to delete cannot be found.\"\r\n                                    });\r\n                                    continue;\r\n                                }\r\n                                if (['SN|Component', 'SN|Theme'].includes(model.content_type)) {\r\n                                    this.deactivateComponent(model, true);\r\n                                }\r\n                                this.modelManager.setItemToBeDeleted(model);\r\n                                // Currently extensions are not notified of association until a full server sync completes.\r\n                                // We manually notify observers.\r\n                                this.modelManager.notifySyncObserversOfModels([model], SFModelManager.MappingSourceRemoteSaved);\r\n                            }\r\n                            this.syncManager.sync();\r\n                            reply = { deleted: true };\r\n                        }\r\n                        else {\r\n                            // Rejected by user\r\n                            reply = { deleted: false };\r\n                        }\r\n                        this.replyToMessage(component, message, reply);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); });\r\n    };\r\n    SNComponentManager.prototype.handleRequestPermissionsMessage = function (component, message) {\r\n        var _this = this;\r\n        this.runWithPermissions(component, message.data.permissions, function () {\r\n            _this.replyToMessage(component, message, { approved: true });\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleSetComponentDataMessage = function (component, message) {\r\n        var _this = this;\r\n        // A component setting its own data does not require special permissions\r\n        this.runWithPermissions(component, [], function () {\r\n            component.componentData = message.data.componentData;\r\n            _this.modelManager.setItemDirty(component, true);\r\n            _this.syncManager.sync();\r\n        });\r\n    };\r\n    SNComponentManager.prototype.handleToggleComponentMessage = function (sourceComponent, targetComponent, message) {\r\n        this.toggleComponent(targetComponent);\r\n    };\r\n    SNComponentManager.prototype.toggleComponent = function (component) {\r\n        var _this = this;\r\n        if (component.area == 'modal') {\r\n            this.openModalComponent(component);\r\n        }\r\n        else {\r\n            if (component.active) {\r\n                this.deactivateComponent(component);\r\n            }\r\n            else {\r\n                if (component.content_type == 'SN|Theme') {\r\n                    // Deactive currently active theme if new theme is not layerable\r\n                    var activeThemes = this.getActiveThemes();\r\n                    // Activate current before deactivating others, so as not to flicker\r\n                    this.activateComponent(component);\r\n                    if (!component.isLayerable()) {\r\n                        setTimeout(function () {\r\n                            for (var _i = 0, activeThemes_1 = activeThemes; _i < activeThemes_1.length; _i++) {\r\n                                var theme = activeThemes_1[_i];\r\n                                if (theme && !theme.isLayerable()) {\r\n                                    _this.deactivateComponent(theme);\r\n                                }\r\n                            }\r\n                        }, 10);\r\n                    }\r\n                }\r\n                else {\r\n                    this.activateComponent(component);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.handleInstallLocalComponentMessage = function (sourceComponent, message) {\r\n        // Only extensions manager has this permission\r\n        if (this.nativeExtManager &&\r\n            !this.nativeExtManager.isSystemExtension(sourceComponent)) {\r\n            return;\r\n        }\r\n        var targetComponent = this.modelManager.findItem(message.data.uuid);\r\n        this.desktopManager.installComponent(targetComponent);\r\n    };\r\n    SNComponentManager.prototype.runWithPermissions = function (component, requiredPermissions, runFunction) {\r\n        if (!component.permissions) {\r\n            component.permissions = [];\r\n        }\r\n        // Make copy as not to mutate input values\r\n        requiredPermissions = JSON.parse(JSON.stringify(requiredPermissions));\r\n        var acquiredPermissions = component.permissions;\r\n        var _loop_4 = function (required) {\r\n            // Remove anything we already have\r\n            var respectiveAcquired = acquiredPermissions.find(function (candidate) { return candidate.name == required.name; });\r\n            if (!respectiveAcquired) {\r\n                return \"continue\";\r\n            }\r\n            // We now match on name, lets substract from required.content_types anything we have in acquired.\r\n            var requiredContentTypes = required.content_types;\r\n            if (!requiredContentTypes) {\r\n                // If this permission does not require any content types (i.e stream-context-item)\r\n                // then we can remove this from required since we match by name (respectiveAcquired.name == required.name)\r\n                pull(requiredPermissions, required);\r\n                return \"continue\";\r\n            }\r\n            for (var _i = 0, _a = respectiveAcquired.content_types; _i < _a.length; _i++) {\r\n                var acquiredContentType = _a[_i];\r\n                // console.log(\"Removing content_type\", acquiredContentType, \"from\", requiredContentTypes);\r\n                pull(requiredContentTypes, acquiredContentType);\r\n            }\r\n            if (requiredContentTypes.length == 0) {\r\n                // We've removed all acquired and end up with zero, means we already have all these permissions\r\n                pull(requiredPermissions, required);\r\n            }\r\n        };\r\n        for (var _i = 0, _a = requiredPermissions.slice(); _i < _a.length; _i++) {\r\n            var required = _a[_i];\r\n            _loop_4(required);\r\n        }\r\n        if (requiredPermissions.length > 0) {\r\n            this.promptForPermissions(component, requiredPermissions, function (approved) {\r\n                if (approved) {\r\n                    runFunction();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            runFunction();\r\n        }\r\n    };\r\n    SNComponentManager.prototype.promptForPermissions = function (component, permissions, callback) {\r\n        var _this = this;\r\n        var params = {};\r\n        params.component = component;\r\n        params.permissions = permissions;\r\n        params.permissionsString = this.permissionsStringForPermissions(permissions, component);\r\n        params.actionBlock = callback;\r\n        params.callback = function (approved) {\r\n            if (approved) {\r\n                var _loop_5 = function (permission) {\r\n                    var matchingPermission = component.permissions.find(function (candidate) { return candidate.name == permission.name; });\r\n                    if (!matchingPermission) {\r\n                        component.permissions.push(permission);\r\n                    }\r\n                    else {\r\n                        // Permission already exists, but content_types may have been expanded\r\n                        var contentTypes = matchingPermission.content_types || [];\r\n                        matchingPermission.content_types = uniq(contentTypes.concat(permission.content_types));\r\n                    }\r\n                };\r\n                for (var _i = 0, permissions_1 = permissions; _i < permissions_1.length; _i++) {\r\n                    var permission = permissions_1[_i];\r\n                    _loop_5(permission);\r\n                }\r\n                _this.modelManager.setItemDirty(component, true);\r\n                _this.syncManager.sync();\r\n            }\r\n            _this.permissionDialogs = _this.permissionDialogs.filter(function (pendingDialog) {\r\n                // Remove self\r\n                if (pendingDialog == params) {\r\n                    pendingDialog.actionBlock && pendingDialog.actionBlock(approved);\r\n                    return false;\r\n                }\r\n                var containsObjectSubset = function (source, target) {\r\n                    return !target.some(function (val) {\r\n                        return !source.find(function (candidate) { return JSON.stringify(candidate) === JSON.stringify(val); });\r\n                    });\r\n                };\r\n                if (pendingDialog.component == component) {\r\n                    // remove pending dialogs that are encapsulated by already approved permissions, and run its function\r\n                    if (pendingDialog.permissions == permissions ||\r\n                        containsObjectSubset(permissions, pendingDialog.permissions)) {\r\n                        // If approved, run the action block. Otherwise, if canceled, cancel any pending ones as well, since the user was\r\n                        // explicit in their intentions\r\n                        if (approved) {\r\n                            pendingDialog.actionBlock && pendingDialog.actionBlock(approved);\r\n                        }\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            });\r\n            if (_this.permissionDialogs.length > 0) {\r\n                _this.presentPermissionsDialog(_this.permissionDialogs[0]);\r\n            }\r\n        };\r\n        // since these calls are asyncronous, multiple dialogs may be requested at the same time. We only want to present one and trigger all callbacks based on one modal result\r\n        var existingDialog = find(this.permissionDialogs, {\r\n            component: component\r\n        });\r\n        this.permissionDialogs.push(params);\r\n        if (!existingDialog) {\r\n            this.presentPermissionsDialog(params);\r\n        }\r\n        else {\r\n            console.log('Existing dialog, not presenting.');\r\n        }\r\n    };\r\n    SNComponentManager.prototype.presentPermissionsDialog = function (dialog) {\r\n        console.error('Must override');\r\n    };\r\n    SNComponentManager.prototype.openModalComponent = function (component) {\r\n        console.error('Must override');\r\n    };\r\n    SNComponentManager.prototype.registerHandler = function (handler) {\r\n        this.handlers.push(handler);\r\n    };\r\n    SNComponentManager.prototype.deregisterHandler = function (identifier) {\r\n        var handler = find(this.handlers, { identifier: identifier });\r\n        if (!handler) {\r\n            console.log('Attempting to deregister non-existing handler');\r\n            return;\r\n        }\r\n        this.handlers.splice(this.handlers.indexOf(handler), 1);\r\n    };\r\n    // Called by other views when the iframe is ready\r\n    SNComponentManager.prototype.registerComponentWindow = function (component, componentWindow) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (component.window === componentWindow) {\r\n                            if (this.loggingEnabled) {\r\n                                console.log('Web|componentManager', 'attempting to re-register same component window.');\r\n                            }\r\n                        }\r\n                        if (this.loggingEnabled) {\r\n                            console.log('Web|componentManager|registerComponentWindow', component);\r\n                        }\r\n                        component.window = componentWindow;\r\n                        _a = component;\r\n                        return [4 /*yield*/, this.SFJS.crypto.generateUUID()];\r\n                    case 1:\r\n                        _a.sessionKey = _b.sent();\r\n                        this.sendMessageToComponent(component, {\r\n                            action: 'component-registered',\r\n                            sessionKey: component.sessionKey,\r\n                            componentData: component.componentData,\r\n                            data: {\r\n                                uuid: component.uuid,\r\n                                environment: this.environment,\r\n                                platform: this.platform,\r\n                                activeThemeUrls: this.urlsForActiveThemes()\r\n                            }\r\n                        });\r\n                        this.postActiveThemesToComponent(component);\r\n                        if (this.desktopManager) {\r\n                            this.desktopManager.notifyComponentActivation(component);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SNComponentManager.prototype.activateComponent = function (component, dontSync) {\r\n        if (dontSync === void 0) { dontSync = false; }\r\n        var didChange = component.active != true;\r\n        component.active = true;\r\n        var _loop_6 = function (handler) {\r\n            if (handler.areas.includes(component.area) ||\r\n                handler.areas.includes('*')) {\r\n                // We want to run the handler in a $timeout so the UI updates, but we also don't want it to run asyncronously\r\n                // so that the steps below this one are run before the handler. So we run in a waitTimeout.\r\n                // Update 12/18: We were using this.waitTimeout previously, however, that caused the iframe.onload callback to never be called\r\n                // for some reason for iframes on desktop inside the revision-preview-modal. So we'll use safeApply instead. I'm not quite sure\r\n                // where the original \"so the UI updates\" comment applies to, but we'll have to keep an eye out to see if this causes problems somewhere else.\r\n                this_2.$uiRunner(function () {\r\n                    handler.activationHandler && handler.activationHandler(component);\r\n                });\r\n            }\r\n        };\r\n        var this_2 = this;\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            _loop_6(handler);\r\n        }\r\n        if (didChange && !dontSync) {\r\n            this.modelManager.setItemDirty(component, true);\r\n            this.syncManager.sync();\r\n        }\r\n        if (!this.activeComponents.includes(component)) {\r\n            this.activeComponents.push(component);\r\n        }\r\n        if (component.area == 'themes') {\r\n            this.postActiveThemesToAllComponents();\r\n        }\r\n    };\r\n    SNComponentManager.prototype.deactivateComponent = function (component, dontSync) {\r\n        if (dontSync === void 0) { dontSync = false; }\r\n        var didChange = component.active != false;\r\n        component.active = false;\r\n        component.sessionKey = null;\r\n        var _loop_7 = function (handler) {\r\n            if (handler.areas.includes(component.area) ||\r\n                handler.areas.includes('*')) {\r\n                // See comment in activateComponent regarding safeApply and awaitTimeout\r\n                this_3.$uiRunner(function () {\r\n                    handler.activationHandler && handler.activationHandler(component);\r\n                });\r\n            }\r\n        };\r\n        var this_3 = this;\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            _loop_7(handler);\r\n        }\r\n        if (didChange && !dontSync) {\r\n            this.modelManager.setItemDirty(component, true);\r\n            this.syncManager.sync();\r\n        }\r\n        pull(this.activeComponents, component);\r\n        this.streamObservers = this.streamObservers.filter(function (o) {\r\n            return o.component !== component;\r\n        });\r\n        this.contextStreamObservers = this.contextStreamObservers.filter(function (o) {\r\n            return o.component !== component;\r\n        });\r\n        if (component.area == 'themes') {\r\n            this.postActiveThemesToAllComponents();\r\n        }\r\n    };\r\n    SNComponentManager.prototype.reloadComponent = function (component) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _loop_8, this_4, _i, _a, handler;\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                //\r\n                // Do soft deactivate\r\n                //\r\n                component.active = false;\r\n                _loop_8 = function (handler) {\r\n                    if (handler.areas.includes(component.area) ||\r\n                        handler.areas.includes('*')) {\r\n                        // See comment in activateComponent regarding safeApply and awaitTimeout\r\n                        this_4.$uiRunner(function () {\r\n                            handler.activationHandler && handler.activationHandler(component);\r\n                        });\r\n                    }\r\n                };\r\n                this_4 = this;\r\n                for (_i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n                    handler = _a[_i];\r\n                    _loop_8(handler);\r\n                }\r\n                this.streamObservers = this.streamObservers.filter(function (o) {\r\n                    return o.component !== component;\r\n                });\r\n                this.contextStreamObservers = this.contextStreamObservers.filter(function (o) {\r\n                    return o.component !== component;\r\n                });\r\n                if (component.area == 'themes') {\r\n                    this.postActiveThemesToAllComponents();\r\n                }\r\n                //\r\n                // Do soft activate\r\n                //\r\n                return [2 /*return*/, new Promise(function (resolve, reject) {\r\n                        _this.$timeout(function () {\r\n                            component.active = true;\r\n                            for (var _i = 0, _a = _this.handlers; _i < _a.length; _i++) {\r\n                                var handler = _a[_i];\r\n                                if (handler.areas.includes(component.area) ||\r\n                                    handler.areas.includes('*')) {\r\n                                    // See comment in activateComponent regarding safeApply and awaitTimeout\r\n                                    _this.$uiRunner(function () {\r\n                                        handler.activationHandler && handler.activationHandler(component);\r\n                                        resolve();\r\n                                    });\r\n                                }\r\n                            }\r\n                            if (!_this.activeComponents.includes(component)) {\r\n                                _this.activeComponents.push(component);\r\n                            }\r\n                            if (component.area == 'themes') {\r\n                                _this.postActiveThemesToAllComponents();\r\n                            }\r\n                            // Resolve again in case first resolve in for loop isn't reached.\r\n                            // Should be no effect if resolved twice, only first will be used.\r\n                            resolve();\r\n                        });\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    SNComponentManager.prototype.deleteComponent = function (component) {\r\n        this.modelManager.setItemToBeDeleted(component);\r\n        this.syncManager.sync();\r\n    };\r\n    SNComponentManager.prototype.isComponentActive = function (component) {\r\n        return component.active;\r\n    };\r\n    SNComponentManager.prototype.iframeForComponent = function (component) {\r\n        for (var _i = 0, _a = Array.from(document.getElementsByTagName('iframe')); _i < _a.length; _i++) {\r\n            var frame = _a[_i];\r\n            var componentId = frame.dataset.componentId;\r\n            if (componentId === component.uuid) {\r\n                return frame;\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.focusChangedForComponent = function (component) {\r\n        var focused = document.activeElement == this.iframeForComponent(component);\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var handler = _a[_i];\r\n            // Notify all handlers, and not just ones that match this component type\r\n            handler.focusHandler && handler.focusHandler(component, focused);\r\n        }\r\n    };\r\n    SNComponentManager.prototype.handleSetSizeEvent = function (component, data) {\r\n        var setSize = function (element, size) {\r\n            var widthString = typeof size.width === 'string' ? size.width : data.width + \"px\";\r\n            var heightString = typeof size.height === 'string' ? size.height : data.height + \"px\";\r\n            if (element) {\r\n                element.setAttribute('style', \"width:\" + widthString + \"; height:\" + heightString + \";\");\r\n            }\r\n        };\r\n        if (component.area == 'rooms' || component.area == 'modal') {\r\n            var selector = component.area == 'rooms' ? 'inner' : 'outer';\r\n            var content = document.getElementById(\"component-content-\" + selector + \"-\" + component.uuid);\r\n            if (content) {\r\n                setSize(content, data);\r\n            }\r\n        }\r\n        else {\r\n            var iframe = this.iframeForComponent(component);\r\n            if (!iframe) {\r\n                return;\r\n            }\r\n            setSize(iframe, data);\r\n            // On Firefox, resizing a component iframe does not seem to have an effect with editor-stack extensions.\r\n            // Sizing the parent does the trick, however, we can't do this globally, otherwise, areas like the note-tags will\r\n            // not be able to expand outside of the bounds (to display autocomplete, for example).\r\n            if (component.area == 'editor-stack') {\r\n                var parent_1 = iframe.parentElement;\r\n                if (parent_1) {\r\n                    setSize(parent_1, data);\r\n                }\r\n            }\r\n            // content object in this case is === to the iframe object above. This is probably\r\n            // legacy code from when we would size content and container individually, which we no longer do.\r\n            // var content = document.getElementById(`component-iframe-${component.uuid}`);\r\n            // console.log(\"content === iframe\", content == iframe);\r\n            // if(content) {\r\n            //   setSize(content, data);\r\n            // }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.editorForNote = function (note) {\r\n        var editors = this.componentsForArea('editor-editor');\r\n        for (var _i = 0, editors_1 = editors; _i < editors_1.length; _i++) {\r\n            var editor = editors_1[_i];\r\n            if (editor.isExplicitlyEnabledForItem(note)) {\r\n                return editor;\r\n            }\r\n        }\r\n        // No editor found for note. Use default editor, if note does not prefer system editor\r\n        if (this.isMobile) {\r\n            if (!note.content.mobilePrefersPlainEditor) {\r\n                return this.getDefaultEditor();\r\n            }\r\n        }\r\n        else {\r\n            if (!note.getAppDataItem('prefersPlainEditor')) {\r\n                return editors.filter(function (e) {\r\n                    return e.isDefaultEditor();\r\n                })[0];\r\n            }\r\n        }\r\n    };\r\n    SNComponentManager.prototype.getDefaultEditor = function () {\r\n        throw new Error('Method not implemented.');\r\n    };\r\n    SNComponentManager.prototype.permissionsStringForPermissions = function (permissions, component) {\r\n        var _this = this;\r\n        var finalString = '';\r\n        var permissionsCount = permissions.length;\r\n        var addSeparator = function (index, length) {\r\n            if (index > 0) {\r\n                if (index == length - 1) {\r\n                    if (length == 2) {\r\n                        return ' and ';\r\n                    }\r\n                    else {\r\n                        return ', and ';\r\n                    }\r\n                }\r\n                else {\r\n                    return ', ';\r\n                }\r\n            }\r\n            return '';\r\n        };\r\n        permissions.forEach(function (permission, index) {\r\n            if (permission.name === 'stream-items') {\r\n                var types = permission.content_types.map(function (type) {\r\n                    var desc = _this.modelManager.humanReadableDisplayForContentType(type);\r\n                    if (desc) {\r\n                        return desc + 's';\r\n                    }\r\n                    else {\r\n                        return 'items of type ' + type;\r\n                    }\r\n                });\r\n                var typesString = '';\r\n                for (var i = 0; i < types.length; i++) {\r\n                    var type = types[i];\r\n                    typesString += addSeparator(i, types.length + permissionsCount - index - 1);\r\n                    typesString += type;\r\n                }\r\n                finalString += addSeparator(index, permissionsCount);\r\n                finalString += typesString;\r\n                if (types.length >= 2 && index < permissionsCount - 1) {\r\n                    // If you have a list of types, and still an additional root-level permission coming up, add a comma\r\n                    finalString += ', ';\r\n                }\r\n            }\r\n            else if (permission.name === 'stream-context-item') {\r\n                var mapping = {\r\n                    'editor-stack': 'working note',\r\n                    'note-tags': 'working note',\r\n                    'editor-editor': 'working note'\r\n                };\r\n                finalString += addSeparator(index, permissionsCount);\r\n                finalString += mapping[component.area];\r\n            }\r\n        });\r\n        return finalString + '.';\r\n    };\r\n    /* This domain will be used to save context item client data */\r\n    SNComponentManager.ClientDataDomain = 'org.standardnotes.sn.components';\r\n    return SNComponentManager;\r\n}());\r\nexport { SNComponentManager };\r\n//# sourceMappingURL=componentManager.js.map","references":["/Users/daj/personal/projects/standard-notes/snjs/node_modules/@types/lodash/ts3.1/find.d.ts","/Users/daj/personal/projects/standard-notes/snjs/node_modules/@types/lodash/ts3.1/pull.d.ts","/Users/daj/personal/projects/standard-notes/snjs/node_modules/@types/lodash/ts3.1/remove.d.ts","/Users/daj/personal/projects/standard-notes/snjs/node_modules/@types/lodash/ts3.1/uniq.d.ts","/Users/daj/personal/projects/standard-notes/snjs/node_modules/standard-file-js/lib/standard_file.js","/Users/daj/personal/projects/standard-notes/snjs/node_modules/standard-file-js/lib/app/lib/modelManager.js"],"map":"{\"version\":3,\"file\":\"componentManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../lib/services/componentManager.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,IAAI,MAAM,aAAa,CAAC;AAC/B,OAAO,IAAI,MAAM,aAAa,CAAC;AAC/B,OAAO,MAAM,MAAM,eAAe,CAAC;AACnC,OAAO,IAAI,MAAM,aAAa,CAAC;AAC/B,OAAO,EAAE,YAAY,EAAE,MAAM,oCAAoC,CAAC;AAClE,OAAO,EAAE,cAAc,EAAE,MAAM,2CAA2C,CAAC;AAE3E;IAuBE;;;MAGE;IACF,4BAAY,EAUX;YATC,8BAAY,EACZ,4BAAW,EACX,kCAAc,EACd,sCAAgB,EAChB,8BAAY,EACZ,wBAAS,EACT,sBAAQ,EACR,4BAAW,EACX,sBAAQ;QAER,kEAAkE;QAClE,IAAI,CAAC,SAAS;YACZ,SAAS;gBACT,CAAC,UAAA,EAAE;oBACD,EAAE,EAAE,CAAC;gBACP,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAEpD,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;QACrC,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;QACzC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QAEjC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,sBAAsB,GAAG,EAAE,CAAC;QACjC,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAE3B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,IAAI,SAAS,CAAC;QAC/C,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,IAAI,QAAQ,CAAC;QAC7C,IAAI,CAAC,IAAI,GAAG,IAAI,YAAY,EAAE,CAAC;QAE/B,IAAI,WAAW,IAAI,QAAQ,EAAE;YAC3B,IAAI,CAAC,0BAA0B,EAAE,CAAC;SACnC;QAED,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAEhC,8BAA8B;QAE9B,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC;QAE5B,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;IACrB,CAAC;IAED,qDAAwB,GAAxB;QAAA,iBAqHC;QApHC,IAAI,CAAC,YAAY,CAAC,mBAAmB,CACnC,mBAAmB,EACnB,GAAG,EACH,UAAC,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,MAAM,EAAE,SAAS;YACpD,IAAI,gBAAgB,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAA,IAAI;gBACzC,OAAO,CACL,IAAI,CAAC,YAAY,KAAK,cAAc;oBACpC,IAAI,CAAC,YAAY,IAAI,UAAU,CAChC,CAAC;YACJ,CAAC,CAAC,CAAC;YAEH;;YAEA;YACA,IACE,gBAAgB,CAAC,MAAM,GAAG,CAAC;gBAC3B,MAAM,IAAI,cAAc,CAAC,wBAAwB,EACjD;gBACA,8DAA8D;gBAC9D,IAAI,KAAI,CAAC,SAAS,EAAE;oBAClB,KAAI,CAAC,cAAc,CAAC,0BAA0B,CAAC,gBAAgB,CAAC,CAAC;iBAClE;aACF;YAED,KAAsB,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB,EAAE;gBAAnC,IAAI,SAAS,yBAAA;gBAChB,IAAI,eAAe,GAAG,IAAI,CAAC,KAAI,CAAC,gBAAgB,EAAE;oBAChD,IAAI,EAAE,SAAS,CAAC,IAAI;iBACrB,CAAC,CAAC;gBACH,IAAI,SAAS,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,IAAI,CAAC,eAAe,EAAE;oBAC9D,KAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;iBACnC;qBAAM,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,eAAe,EAAE;oBAC/C,KAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC;iBACrC;aACF;oCAEQ,QAAQ;gBACf,IAAI,SAAS,IAAI,SAAS,IAAI,QAAQ,CAAC,SAAS,CAAC,IAAI,EAAE;;iBAGtD;gBAED,IAAI,aAAa,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAA,IAAI;oBACtC,OAAO,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;gBACjE,CAAC,CAAC,CAAC;gBAEH,IAAI,aAAa,CAAC,MAAM,IAAI,CAAC,EAAE;;iBAE9B;gBAED,IAAI,mBAAmB,GAAG;oBACxB;wBACE,IAAI,EAAE,cAAc;wBACpB,aAAa,EAAE,QAAQ,CAAC,YAAY,CAAC,IAAI,EAAE;qBAC5C;iBACF,CAAC;gBAEF,KAAI,CAAC,kBAAkB,CACrB,QAAQ,CAAC,SAAS,EAClB,mBAAmB,EACnB;oBACE,KAAI,CAAC,gBAAgB,CACnB,QAAQ,CAAC,SAAS,EAClB,aAAa,EACb,QAAQ,CAAC,eAAe,CACzB,CAAC;gBACJ,CAAC,CACF,CAAC;;YA/BJ,KAAqB,UAAoB,EAApB,KAAA,KAAI,CAAC,eAAe,EAApB,cAAoB,EAApB,IAAoB;gBAApC,IAAI,QAAQ,SAAA;wBAAR,QAAQ;aAgChB;YAED,IAAI,0BAA0B,GAAG;gBAC/B;oBACE,IAAI,EAAE,qBAAqB;iBAC5B;aACF,CAAC;oCAEO,QAAQ;gBACf,IAAI,SAAS,IAAI,SAAS,IAAI,QAAQ,CAAC,SAAS,CAAC,IAAI,EAAE;;iBAGtD;gBAED,KAAoB,UAAa,EAAb,KAAA,KAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;oBAA9B,IAAI,OAAO,SAAA;oBACd,IACE,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC;wBAChD,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC5B;wBACA,SAAS;qBACV;oBACD,IAAI,OAAO,CAAC,qBAAqB,EAAE;wBAC7B,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAC/C,QAAQ,CAAC,SAAS,CACnB,CAAC;wBACF,IAAI,aAAa,EAAE;4BACb,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE;gCAChC,IAAI,EAAE,aAAa,CAAC,IAAI;6BACzB,CAAC,CAAC;4BACH,IAAI,YAAY,EAAE;gCAChB,KAAI,CAAC,kBAAkB,CACrB,QAAQ,CAAC,SAAS,EAClB,0BAA0B,EAC1B;oCACE,KAAI,CAAC,sBAAsB,CACzB,QAAQ,CAAC,SAAS,EAClB,YAAY,EACZ,QAAQ,CAAC,eAAe,EACxB,MAAM,CACP,CAAC;gCACJ,CAAC,CACF,CAAC;6BACH;yBACF;qBACF;iBACF;;gBAvBO,aAAa,EAIX,YAAY;YAlBxB,KAAqB,UAA2B,EAA3B,KAAA,KAAI,CAAC,sBAAsB,EAA3B,cAA2B,EAA3B,IAA2B;gBAA3C,IAAI,QAAQ,SAAA;wBAAR,QAAQ;aAsChB;QACH,CAAC,CACF,CAAC;IACJ,CAAC;IAED,uDAA0B,GAA1B;QAAA,iBA4CC;QA3CC,IAAM,iBAAiB,GAAG,UAAA,KAAK;YAC7B,KAAsB,UAAqB,EAArB,KAAA,KAAI,CAAC,gBAAgB,EAArB,cAAqB,EAArB,IAAqB,EAAE;gBAAxC,IAAI,SAAS,SAAA;gBAChB,IAAI,QAAQ,CAAC,aAAa,IAAI,KAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,EAAE;oBAChE,KAAI,CAAC,QAAQ,CAAC;wBACZ,KAAI,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;oBAC3C,CAAC,CAAC,CAAC;oBACH,MAAM;iBACP;aACF;QACH,CAAC,CAAC;QAEF,MAAM,CAAC,gBAAgB;YACrB,CAAC,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,iBAAiB,EAAE,IAAI,CAAC;YAC3D,CAAC,CAAE,MAAc,CAAC,WAAW,CAAC,YAAY,EAAE,iBAAiB,CAAC,CAAC;QACjE,MAAM,CAAC,gBAAgB;YACrB,CAAC,CAAC,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,iBAAiB,EAAE,IAAI,CAAC;YAC1D,CAAC,CAAE,MAAc,CAAC,WAAW,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;QAE7D,IAAI,CAAC,cAAc,CAAC,sBAAsB,CAAC,UAAA,SAAS;YAClD,yBAAyB;YACzB,IAAI,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,OAAO,EAAE,EAAE;gBAC3C,KAAI,CAAC,+BAA+B,EAAE,CAAC;aACxC;QACH,CAAC,CAAC,CAAC;QAEH,oEAAoE;QACpE,MAAM,CAAC,gBAAgB,CACrB,SAAS,EACT,UAAA,KAAK;YACH,IAAI,KAAI,CAAC,cAAc,EAAE;gBACvB,OAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;aACjD;YAED,mCAAmC;YACnC,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE;gBACzB,KAAI,CAAC,aAAa,CAChB,KAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,EAClD,KAAK,CAAC,IAAI,CACX,CAAC;aACH;QACH,CAAC,EACD,KAAK,CACN,CAAC;IACJ,CAAC;IAED,4DAA+B,GAA/B;QACE,KAAsB,UAAe,EAAf,KAAA,IAAI,CAAC,UAAU,EAAf,cAAe,EAAf,IAAe,EAAE;YAAlC,IAAI,SAAS,SAAA;YAChB,mDAAmD;YACnD,4EAA4E;YAC5E,IAAI,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;gBACjE,SAAS;aACV;YAED,IAAI,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;SAC7C;IACH,CAAC;IAED,4CAAe,GAAf;QACE,OAAO,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAA,KAAK;YAClD,OAAO,KAAK,CAAC,MAAM,CAAC;QACtB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,gDAAmB,GAAnB;QAAA,iBAKC;QAJC,IAAI,MAAM,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QACpC,OAAO,MAAM,CAAC,GAAG,CAAC,UAAA,KAAK;YACrB,OAAO,KAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,wDAA2B,GAA3B,UAA4B,SAAS;QACnC,IAAI,IAAI,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;QACtC,IAAI,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QAE5B,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IAC3E,CAAC;IAED,uDAA0B,GAA1B,UAA2B,IAAI;QAC7B,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA9B,IAAI,OAAO,SAAA;YACd,IACE,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,KAAK;gBACtC,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC5B;gBACA,SAAS;aACV;YACD,IAAI,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAA,QAAQ;gBACzD,OAAO,QAAQ,CAAC,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC;YAC1C,CAAC,CAAC,CAAC;YAEH,KAAqB,UAAS,EAAT,uBAAS,EAAT,uBAAS,EAAT,IAAS,EAAE;gBAA3B,IAAI,QAAQ,kBAAA;gBACf,IAAI,OAAO,CAAC,qBAAqB,EAAE;oBACjC,IAAI,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;oBACtE,IAAI,aAAa,EAAE;wBACjB,IAAI,CAAC,sBAAsB,CACzB,QAAQ,CAAC,SAAS,EAClB,aAAa,EACb,QAAQ,CAAC,eAAe,CACzB,CAAC;qBACH;iBACF;aACF;SACF;IACH,CAAC;IAED,+CAAkB,GAAlB,UAAmB,SAAS,EAAE,MAAM;QAClC;;;;UAIE;QACF,IAAI,MAAM,EAAE;YACV,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;SACzB;aAAM,IAAI,SAAS,CAAC,MAAM,EAAE;YAC3B,+FAA+F;YAC/F,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;YAEzB,oBAAoB;YACpB,IAAI,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE;gBACtD,UAAU,EAAE,SAAS,CAAC,IAAI;aAC3B,CAAC,CAAC;YACH,IAAI,eAAe,EAAE;gBACnB,IAAI,CAAC,8BAA8B,CACjC,SAAS,EACT,eAAe,CAAC,eAAe,CAChC,CAAC;aACH;YAED,cAAc;YACd,IAAI,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;gBAC9C,UAAU,EAAE,SAAS,CAAC,IAAI;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,EAAE;gBAClB,IAAI,CAAC,wBAAwB,CAC3B,SAAS,EACT,cAAc,CAAC,eAAe,CAC/B,CAAC;aACH;SACF;IACH,CAAC;IAED,wCAAW,GAAX,UAAY,IAAI,EAAE,SAAS,EAAE,MAAO;QAClC,IAAI,MAAM,GAAQ;YAChB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,OAAO,EAAE,IAAI,CAAC,OAAO;SACtB,CAAC;QACF,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,+BAA+B,EAAE,CAAC;QACxD,MAAM,CAAC,UAAU;YACf,IAAI,CAAC,iBAAiB,CACpB,SAAS,CAAC,gBAAgB,EAAE,EAC5B,kBAAkB,CAAC,gBAAgB,CACpC,IAAI,EAAE,CAAC;QAEV,yFAAyF;QACzF,kGAAkG;QAClG,4JAA4J;QAC5J,EAAE;QACF,IACE,MAAM;YACN,CAAC,MAAM,IAAI,cAAc,CAAC,wBAAwB;gBAChD,MAAM,IAAI,cAAc,CAAC,uBAAuB,CAAC,EACnD;YACA,MAAM,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAChC;QAED,IAAI,CAAC,wCAAwC,CAAC,CAAC,MAAM,CAAC,EAAE,SAAS,EAAE;YACjE,IAAI,EAAE,UAAU;SACjB,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,6CAAgB,GAAhB,UAAiB,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,MAAO;QAAnD,iBAgBC;QAfC,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,OAAO,CAAC,GAAG,CACT,uCAAuC,EACvC,SAAS,EACT,KAAK,EACL,OAAO,CACR,CAAC;SACH;QACD,IAAI,QAAQ,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;QAC7B,IAAI,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI;YACzB,OAAO,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,QAAQ,CAAC,KAAK,GAAG,MAAM,CAAC;QACxB,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IACpD,CAAC;IAED,mDAAsB,GAAtB,UAAuB,SAAS,EAAE,IAAI,EAAE,eAAe,EAAE,MAAO;QAC9D,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,OAAO,CAAC,GAAG,CACT,6CAA6C,EAC7C,SAAS,EACT,IAAI,EACJ,eAAe,CAChB,CAAC;SACH;QACD,IAAI,QAAQ,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,CAAC;QACnE,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,eAAe,EAAE,QAAQ,CAAC,CAAC;IAC5D,CAAC;IAED,2CAAc,GAAd,UAAe,SAAS,EAAE,eAAe,EAAE,SAAS;QAClD,IAAI,KAAK,GAAG;YACV,MAAM,EAAE,OAAO;YACf,QAAQ,EAAE,eAAe;YACzB,IAAI,EAAE,SAAS;SAChB,CAAC;QAEF,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;IAChD,CAAC;IAED,mDAAsB,GAAtB,UAAuB,SAAS,EAAE,OAAO;QACvC,IAAI,6BAA6B,GAAG,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;QACvE,IACE,SAAS,CAAC,MAAM;YAChB,CAAC,6BAA6B,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,EACvD;YACA,IAAI,IAAI,CAAC,cAAc,EAAE;gBACvB,OAAO,CAAC,GAAG,CACT,gEAAgE,EAChE,SAAS,CAAC,IAAI,CACf,CAAC;aACH;YACD,OAAO;SACR;QAED,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;SAC/D;QAED,IAAI,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QACxD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;YAC5D,uDAAuD;YACvD,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,MAAM,CAAC;SACxC;QAED,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;YACrB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;gBACtB,IAAI,EAAE,kDAAgD,SAAS,CAAC,IAAI,8EAA2E;aAChJ,CAAC,CAAC;SACJ;QAED,iCAAiC;QACjC,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QAED,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;IAChD,CAAC;IAED,sBAAI,0CAAU;aAAd;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC;gBAC7C,cAAc;gBACd,UAAU;aACX,CAAC,CAAC;QACL,CAAC;;;OAAA;IAED,8CAAiB,GAAjB,UAAkB,IAAI;QACpB,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,UAAA,SAAS;YACrC,OAAO,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC;QACjC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,4CAAe,GAAf,UAAgB,SAAS,EAAE,aAAkB;QAAlB,8BAAA,EAAA,kBAAkB;QAC3C,sEAAsE;QACtE,IAAI,SAAS,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YAC5C,OAAO,IAAI,CAAC;SACb;QAED,IAAI,SAAS,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,SAAS,CAAC,EAAE;YACpE,OAAO,CACL,SAAS,CAAC,SAAS;gBACnB,SAAS,CAAC,SAAS,CAAC,OAAO,CACzB,OAAO,EACP,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,sBAAsB,EAAE,GAAG,GAAG,CACnE,CACF,CAAC;SACH;aAAM;YACL,IAAI,GAAG,GAAG,SAAS,CAAC,UAAU,IAAI,SAAS,CAAC,UAAU,CAAC;YACvD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,gBAAgB,GAClB,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,UAAU,CAAC;gBACpD,GAAG,GAAG,GAAG;qBACN,OAAO,CAAC,WAAW,EAAE,gBAAgB,CAAC;qBACtC,OAAO,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;aAC1C;YACD,OAAO,GAAG,CAAC;SACZ;IACH,CAAC;IAED,4CAAe,GAAf,UAAgB,GAAG;QACjB,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,UAAA,SAAS;YACrC,OAAO,SAAS,CAAC,UAAU,KAAK,GAAG,IAAI,SAAS,CAAC,UAAU,KAAK,GAAG,CAAC;QACtE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;IAED,mDAAsB,GAAtB,UAAuB,GAAG;QACxB,IAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,UAAU,EAAE,GAAG,EAAE,CAAC,CAAC;QAC3D,IAAI,CAAC,SAAS,EAAE;YACd,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;gBAA9B,IAAI,OAAO,SAAA;gBACd,IAAI,OAAO,CAAC,6BAA6B,EAAE;oBACzC,SAAS,GAAG,OAAO,CAAC,6BAA6B,CAAC,GAAG,CAAC,CAAC;oBACvD,IAAI,SAAS,EAAE;wBACb,MAAM;qBACP;iBACF;aACF;SACF;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,0CAAa,GAAb,UAAc,SAAS,EAAE,OAAO;QAC9B,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,CAAC,GAAG,CAAC,8CAA8C,EAAE,OAAO,CAAC,CAAC;YACrE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;gBACtB,IAAI,EACF,+IAA+I;aAClJ,CAAC,CAAC;YACH,OAAO;SACR;QAED,iDAAiD;QACjD,IAAI,gBAAgB,GAAG;YACrB,YAAY;YACZ,gBAAgB;YAChB,kBAAkB;YAClB,aAAa;YACb,cAAc;YACd,cAAc;YACd,oBAAoB;SACrB,CAAC;QAEF,IAAI,SAAS,CAAC,QAAQ,IAAI,gBAAgB,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YACnE,qEAAqE;YACrE,wFAAwF;YACxF,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;gBACtB,IAAI,EAAE,mBAAiB,SAAS,CAAC,IAAI,+EAA4E;aAClH,CAAC,CAAC;YACH,OAAO;SACR;QAED;;;;;;;;;;;;;;;;;;UAkBE;QAEF,IAAI,OAAO,CAAC,MAAM,KAAK,cAAc,EAAE;YACrC,IAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACnD;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,qBAAqB,EAAE;YACnD,IAAI,CAAC,8BAA8B,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACzD;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,oBAAoB,EAAE;YAClD,IAAI,CAAC,6BAA6B,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACxD;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,cAAc,EAAE;YAC5C,IAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACnD;aAAM,IACL,OAAO,CAAC,MAAM,KAAK,cAAc;YACjC,OAAO,CAAC,MAAM,KAAK,aAAa,EAChC;YACA,IAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACnD;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,YAAY,EAAE;YAC1C,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACjD;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,2BAA2B,EAAE;YACzD,IAAI,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACtE,IAAI,CAAC,4BAA4B,CAAC,SAAS,EAAE,iBAAiB,EAAE,OAAO,CAAC,CAAC;SAC1E;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,qBAAqB,EAAE;YACnD,IAAI,CAAC,+BAA+B,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SAC1D;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,yBAAyB,EAAE;YACvD,IAAI,CAAC,kCAAkC,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SAC7D;aAAM,IAAI,OAAO,CAAC,MAAM,KAAK,gBAAgB,EAAE;YAC9C,IAAI,CAAC,0BAA0B,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACrD;gCAGQ,OAAO;YACd,IACE,OAAO,CAAC,aAAa;gBACrB,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EACvE;gBACA,OAAK,QAAQ,CAAC;oBACZ,OAAO,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;gBACjE,CAAC,CAAC,CAAC;aACJ;;;QATH,mBAAmB;QACnB,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa;YAA5B,IAAI,OAAO,SAAA;oBAAP,OAAO;SASf;IACH,CAAC;IAED,qEAAwC,GAAxC,UACE,aAAa,EACb,SAAS,EACT,OAAiB;QAAjB,wBAAA,EAAA,YAAiB;QAEjB,qGAAqG;QACrG,IAAI,OAAO,CAAC,IAAI,IAAI,UAAU,EAAE;YAC9B,IAAI,yBAAyB,GAAG,CAAC,YAAY,CAAC,CAAC;YAC/C,8GAA8G;YAC9G,KAAyB,UAAa,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;gBAAnC,IAAI,YAAY,sBAAA;gBACnB,IAAI,OAAO,YAAY,CAAC,QAAQ,KAAK,UAAU,EAAE;oBAC/C,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;oBACtD,SAAS;iBACV;gBACD,KAA4B,UAAyB,EAAzB,uDAAyB,EAAzB,uCAAyB,EAAzB,IAAyB,EAAE;oBAAlD,IAAI,eAAe,kCAAA;oBACtB,OAAO,YAAY,CAAC,eAAe,CAAC,CAAC;iBACtC;aACF;SACF;QAED,IAAI,SAAS,EAAE;YACb,yCAAyC;YACzC,IACE,IAAI,CAAC,gBAAgB;gBACrB,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAClD;gBACA,OAAO;aACR;SACF;QACD,uDAAuD;QACvD,IAAI,wBAAwB,GAAG;YAC7B,oBAAoB;YACpB,aAAa;YACb,QAAQ;SACT,CAAC;QACF,IAAI,OAAO,EAAE;YACX,IAAI,OAAO,CAAC,WAAW,EAAE;gBACvB,wBAAwB,GAAG,wBAAwB,CAAC,MAAM,CAAC;oBACzD,KAAK;oBACL,YAAY;oBACZ,WAAW;iBACZ,CAAC,CAAC;aACJ;SACF;QACD,KAAyB,UAAa,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;YAAnC,IAAI,YAAY,sBAAA;YACnB,yEAAyE;YACzE,qDAAqD;YACrD,IAAI,OAAO,YAAY,CAAC,QAAQ,KAAK,UAAU,EAAE;gBAC/C,OAAO,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;gBACtD,SAAS;aACV;YAED,KAAiB,UAAwB,EAAxB,qDAAwB,EAAxB,sCAAwB,EAAxB,IAAwB,EAAE;gBAAtC,IAAI,IAAI,iCAAA;gBACX,OAAO,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;aACnC;SACF;IACH,CAAC;IAED,qDAAwB,GAAxB,UAAyB,SAAS,EAAE,OAAO;QAA3C,iBA4BC;QA3BC,IAAI,mBAAmB,GAAG;YACxB;gBACE,IAAI,EAAE,cAAc;gBACpB,aAAa,EAAE,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE;aACjD;SACF,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;YACtD,IAAI,CAAC,IAAI,CAAC,KAAI,CAAC,eAAe,EAAE,EAAE,UAAU,EAAE,SAAS,CAAC,IAAI,EAAE,CAAC,EAAE;gBAC/D,wCAAwC;gBACxC,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC;oBACxB,UAAU,EAAE,SAAS,CAAC,IAAI;oBAC1B,SAAS,EAAE,SAAS;oBACpB,eAAe,EAAE,OAAO;oBACxB,YAAY,EAAE,OAAO,CAAC,IAAI,CAAC,aAAa;iBACzC,CAAC,CAAC;aACJ;YAED,uBAAuB;YACvB,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,KAAwB,UAA0B,EAA1B,KAAA,OAAO,CAAC,IAAI,CAAC,aAAa,EAA1B,cAA0B,EAA1B,IAA0B,EAAE;gBAA/C,IAAI,WAAW,SAAA;gBAClB,KAAK,GAAG,KAAK,CAAC,MAAM,CAClB,KAAI,CAAC,YAAY,CAAC,wBAAwB,CAAC,WAAW,CAAC,CACxD,CAAC;aACH;YACD,KAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;IACL,CAAC;IAED,2DAA8B,GAA9B,UAA+B,SAAS,EAAE,OAAO;QAAjD,iBA2BC;QA1BC,IAAI,mBAAmB,GAAG;YACxB;gBACE,IAAI,EAAE,qBAAqB;aAC5B;SACF,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;YACtD,IAAI,CAAC,IAAI,CAAC,KAAI,CAAC,sBAAsB,EAAE,EAAE,UAAU,EAAE,SAAS,CAAC,IAAI,EAAE,CAAC,EAAE;gBACtE,wCAAwC;gBACxC,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC;oBAC/B,UAAU,EAAE,SAAS,CAAC,IAAI;oBAC1B,SAAS,EAAE,SAAS;oBACpB,eAAe,EAAE,OAAO;iBACzB,CAAC,CAAC;aACJ;YAED,uBAAuB;YACvB,KAAoB,UAAoC,EAApC,KAAA,KAAI,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,EAApC,cAAoC,EAApC,IAAoC,EAAE;gBAArD,IAAI,OAAO,SAAA;gBACd,IAAI,OAAO,CAAC,qBAAqB,EAAE;oBACjC,IAAI,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;oBAC7D,IAAI,aAAa,EAAE;wBACjB,KAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;qBAChE;iBACF;aACF;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,uEAA0C,GAA1C,UAA2C,IAAI,EAAE,SAAS;QACxD,IAAI,qBAAqB,GAAG,IAAI,CAAC,wCAAwC,CACvE,SAAS,CACV,CAAC;QACF,OAAO,qBAAqB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC9C,CAAC;IAED,oEAAoE;IACpE,qEAAwC,GAAxC,UAAyC,SAAS;QAChD,IAAI,OAAO,GAAU,EAAE,CAAC;QACxB,KAAoB,UAAoC,EAApC,KAAA,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,EAApC,cAAoC,EAApC,IAAoC,EAAE;YAArD,IAAI,OAAO,SAAA;YACd,IAAI,OAAO,CAAC,qBAAqB,EAAE;gBACjC,IAAI,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;gBAC7D,IAAI,aAAa,EAAE;oBACjB,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAClC;aACF;SACF;QAED,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,4CAAe,GAAf,UAAgB,IAAI;QAClB,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAA,SAAS;YACnC,OAAO,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;IACL,CAAC;IAEK,mDAAsB,GAA5B,UAA6B,SAAS,EAAE,OAAO;;;;;gBACzC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;gBACnC,mBAAmB,GAAU,EAAE,CAAC;gBAEhC,4BAA4B,GAAG,IAAI,CAAC,wCAAwC,CAC9E,SAAS,CACV,CAAC;gBAGE,oBAAoB,GAAG,aAAa,CAAC,KAAK,EAAE,CAAC;gBAEjD,WAA8C,EAArB,KAAA,aAAa,CAAC,KAAK,EAAE,EAArB,cAAqB,EAArB,IAAqB,EAAE;oBAAvC,YAAY;oBACnB,IAAI,4BAA4B,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE;wBAC5D,mBAAmB,CAAC,IAAI,CAAC;4BACvB,IAAI,EAAE,qBAAqB;yBAC5B,CAAC,CAAC;wBACH,IAAI,CAAC,oBAAoB,EAAE,YAAY,CAAC,CAAC;wBACzC,sDAAsD;wBACtD,MAAM;qBACP;iBACF;gBAED,qDAAqD;gBACrD,IAAI,oBAAoB,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC/B,oBAAoB,GAAG,IAAI,CAC7B,oBAAoB,CAAC,GAAG,CAAC,UAAA,CAAC;wBACxB,OAAO,CAAC,CAAC,YAAY,CAAC;oBACxB,CAAC,CAAC,CACH,CAAC,IAAI,EAAE,CAAC;oBACT,mBAAmB,CAAC,IAAI,CAAC;wBACvB,IAAI,EAAE,cAAc;wBACpB,aAAa,EAAE,oBAAoB;qBACpC,CAAC,CAAC;iBACJ;gBAED,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;;;;;;gCACtD,IAAI,CAAC,wCAAwC,CAAC,aAAa,EAAE,SAAS,EAAE;oCACtE,WAAW,EAAE,IAAI;oCACjB,IAAI,EAAE,UAAU;iCACjB,CAAC,CAAC;gCAQC,GAAG,GAAG,aAAa,CAAC,GAAG,CAAC,UAAA,CAAC;oCAC3B,OAAO,CAAC,CAAC,IAAI,CAAC;gCAChB,CAAC,CAAC,CAAC;gCACC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;gCACzC,WAAW,GAAG,CAAC,CAAC;gCACpB,WAAsB,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK,EAAE;oCAAf,IAAI;oCACX,IAAI,IAAI,CAAC,MAAM,EAAE;wCACf,MAAM,CAAC,aAAa,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;wCAC3C,WAAW,EAAE,CAAC;qCACf;iCACF;gCAED,IAAI,WAAW,GAAG,CAAC,EAAE;oCACf,QAAQ,GAAG,WAAW,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC;oCAC/C,OAAO,GAAG,WAAW,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;oCAC9C,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;wCACtB,KAAK,EAAE,cAAc;wCACrB,IAAI,EAAK,WAAW,SAAI,QAAQ,oCAA+B,OAAO,kCAA+B;qCACtG,CAAC,CAAC;iCACJ;gCAEgB,qBAAM,IAAI,CAAC,YAAY,CAAC,6BAA6B,CACpE,aAAa,EACb,cAAc,CAAC,+BAA+B,EAC9C,SAAS,CAAC,IAAI,CACf,EAAA;;gCAJG,UAAU,GAAG,SAIhB;gCAED,WAAsC,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;oCAA/B,YAAY;oCACf,IAAI,GAAG,IAAI,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC;oCACzD,IAAI,CAAC,IAAI,EAAE;wCACT,qFAAqF;wCACrF,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;4CACtB,IAAI,EAAE,mBAAiB,SAAS,CAAC,IAAI,6CAAwC,YAAY,CAAC,YAAY,iFAA8E;yCACrL,CAAC,CAAC;wCACH,SAAS;qCACV;oCAED,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;wCAChB,IAAI,YAAY,CAAC,UAAU,EAAE;4CAC3B,IAAI,CAAC,iBAAiB,CACpB,SAAS,CAAC,gBAAgB,EAAE,EAC5B,YAAY,CAAC,UAAU,EACvB,kBAAkB,CAAC,gBAAgB,CACpC,CAAC;yCACH;wCACD,IAAI,CAAC,YAAY,CAAC,YAAY,CAC5B,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,cAAc,CAAC,+BAA+B,EAC9C,SAAS,CAAC,IAAI,CACf,CAAC;qCACH;iCACF;gCAED,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,UAAA,QAAQ;oCACnC,8EAA8E;oCAC9E,IAAI,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;oCAC7C,WAAW,CAAC,MAAM;wCAChB,QAAQ,IAAI,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,cAAc,CAAC;oCAC7D,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE;wCACtC,KAAK,EAAE,QAAQ,IAAI,QAAQ,CAAC,KAAK;qCAClC,CAAC,CAAC;oCACH,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;gCAC7C,CAAC,CAAC,CAAC;;;;qBACJ,CAAC,CAAC;;;;KACJ;IAED,uDAA0B,GAA1B,UAA2B,SAAS,EAAE,OAAO;QAA7C,iBAkBC;QAjBC,IAAI,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;QACnC,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACvD,IAAI,mBAAmB,GAAG;YACxB;gBACE,IAAI,EAAE,cAAc;gBACpB,aAAa,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC;aACnC;SACF,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;YACtD,IAAI,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAC5D,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;YAExB,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE;gBACtC,IAAI,EAAE,KAAI,CAAC,WAAW,CAAC,SAAS,EAAE,SAAS,CAAC;aAC7C,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qDAAwB,GAAxB,UAAyB,SAAS,EAAE,OAAO;QAA3C,iBAkDC;QAjDC,IAAI,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI;YACnC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;YACrB,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;QACvB,IAAI,kBAAkB,GAAG,IAAI,CAC3B,aAAa,CAAC,GAAG,CAAC,UAAA,IAAI;YACpB,OAAO,IAAI,CAAC,YAAY,CAAC;QAC3B,CAAC,CAAC,CACH,CAAC;QACF,IAAI,mBAAmB,GAAG;YACxB;gBACE,IAAI,EAAE,cAAc;gBACpB,aAAa,EAAE,kBAAkB;aAClC;SACF,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;YACtD,KAAI,CAAC,wCAAwC,CAAC,aAAa,EAAE,SAAS,EAAE;gBACtE,IAAI,EAAE,UAAU;aACjB,CAAC,CAAC;YACH,IAAI,cAAc,GAAU,EAAE,CAAC;YAC/B,KAAyB,UAAa,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;gBAAnC,IAAI,YAAY,sBAAA;gBACnB,IAAI,IAAI,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;gBACtD,IAAI,YAAY,CAAC,UAAU,EAAE;oBAC3B,IAAI,CAAC,iBAAiB,CACpB,SAAS,CAAC,gBAAgB,EAAE,EAC5B,YAAY,CAAC,UAAU,EACvB,kBAAkB,CAAC,gBAAgB,CACpC,CAAC;iBACH;gBACD,KAAI,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAChC,KAAI,CAAC,YAAY,CAAC,wBAAwB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;gBACvD,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;gBAC3C,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAC3B;YAED,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;YAExB,qEAAqE;YACrE,IAAI,KAAK,GACP,OAAO,CAAC,MAAM,IAAI,aAAa;gBAC7B,CAAC,CAAC,EAAE,IAAI,EAAE,KAAI,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,EAAE;gBAC1D,CAAC,CAAC;oBACE,KAAK,EAAE,cAAc,CAAC,GAAG,CAAC,UAAA,IAAI;wBAC5B,OAAO,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;oBAC3C,CAAC,CAAC;iBACH,CAAC;YAER,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qDAAwB,GAAxB,UAAyB,SAAS,EAAE,OAAO;QAA3C,iBA0DC;QAzDC,IAAI,oBAAoB,GAAG,IAAI,CAC7B,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,CAAC;YACtB,OAAO,CAAC,CAAC,YAAY,CAAC;QACxB,CAAC,CAAC,CACH,CAAC,IAAI,EAAE,CAAC;QACT,IAAI,mBAAmB,GAAG;YACxB;gBACE,IAAI,EAAE,cAAc;gBACpB,aAAa,EAAE,oBAAoB;aACpC;SACF,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,mBAAmB,EAAE;;;;;wBAClD,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;wBAC/B,IAAI,GAAG,SAAS,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC;wBAGhD,UAAU,GAAG,IAAI,CAAC;wBACtB,qBAAM,IAAI,CAAC,YAAY;iCACpB,OAAO,CAAC;gCACP,IAAI,EAAE,qCAAmC,SAAS,CAAC,MAAM,SAAI,IAAI,MAAG;6BACrE,CAAC;iCACD,KAAK,CAAC;gCACL,UAAU,GAAG,KAAK,CAAC;4BACrB,CAAC,CAAC,EAAA;;wBANJ,SAMI,CAAC;wBAEL,IAAI,UAAU,EAAE;4BACd,2DAA2D;4BAC3D,WAA8B,EAAT,uBAAS,EAAT,uBAAS,EAAT,IAAS,EAAE;gCAAvB,QAAQ;gCACX,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gCACtD,IAAI,CAAC,KAAK,EAAE;oCACV,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;wCACtB,IAAI,EAAE,oDAAoD;qCAC3D,CAAC,CAAC;oCACH,SAAS;iCACV;gCACD,IAAI,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE;oCAC7D,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;iCACvC;gCACD,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;gCAC5C,2FAA2F;gCAC3F,gCAAgC;gCAChC,IAAI,CAAC,YAAY,CAAC,2BAA2B,CAC3C,CAAC,KAAK,CAAC,EACP,cAAc,CAAC,wBAAwB,CACxC,CAAC;6BACH;4BAED,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;4BACxB,KAAK,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;yBAC3B;6BAAM;4BACL,mBAAmB;4BACnB,KAAK,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;yBAC5B;wBAED,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;;;;aAChD,CAAC,CAAC;IACL,CAAC;IAED,4DAA+B,GAA/B,UAAgC,SAAS,EAAE,OAAO;QAAlD,iBAIC;QAHC,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE;YAC3D,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;IACL,CAAC;IAED,0DAA6B,GAA7B,UAA8B,SAAS,EAAE,OAAO;QAAhD,iBAOC;QANC,wEAAwE;QACxE,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,EAAE,EAAE;YACrC,SAAS,CAAC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAChD,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,yDAA4B,GAA5B,UAA6B,eAAe,EAAE,eAAe,EAAE,OAAO;QACpE,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;IACxC,CAAC;IAED,4CAAe,GAAf,UAAgB,SAAS;QAAzB,iBA4BC;QA3BC,IAAI,SAAS,CAAC,IAAI,IAAI,OAAO,EAAE;YAC7B,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;SACpC;aAAM;YACL,IAAI,SAAS,CAAC,MAAM,EAAE;gBACpB,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC;aACrC;iBAAM;gBACL,IAAI,SAAS,CAAC,YAAY,IAAI,UAAU,EAAE;oBACxC,gEAAgE;oBAChE,IAAI,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;oBAE1C,oEAAoE;oBACpE,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;oBAElC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE;wBAC5B,UAAU,CAAC;4BACT,KAAkB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY,EAAE;gCAA3B,IAAI,KAAK,qBAAA;gCACZ,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE;oCACjC,KAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;iCACjC;6BACF;wBACH,CAAC,EAAE,EAAE,CAAC,CAAC;qBACR;iBACF;qBAAM;oBACL,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;iBACnC;aACF;SACF;IACH,CAAC;IAED,+DAAkC,GAAlC,UAAmC,eAAe,EAAE,OAAO;QACzD,8CAA8C;QAC9C,IACE,IAAI,CAAC,gBAAgB;YACrB,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,eAAe,CAAC,EACzD;YACA,OAAO;SACR;QAED,IAAI,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;IACxD,CAAC;IAED,+CAAkB,GAAlB,UAAmB,SAAS,EAAE,mBAAmB,EAAE,WAAW;QAC5D,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;YAC1B,SAAS,CAAC,WAAW,GAAG,EAAE,CAAC;SAC5B;QAED,0CAA0C;QAC1C,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC,CAAC;QAEtE,IAAI,mBAAmB,GAAG,SAAS,CAAC,WAAW,CAAC;gCAEvC,QAAQ;YACf,kCAAkC;YAClC,IAAI,kBAAkB,GAAG,mBAAmB,CAAC,IAAI,CAC/C,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,IAAI,IAAI,QAAQ,CAAC,IAAI,EAA/B,CAA+B,CAC7C,CAAC;YACF,IAAI,CAAC,kBAAkB,EAAE;;aAExB;YAED,iGAAiG;YACjG,IAAI,oBAAoB,GAAG,QAAQ,CAAC,aAAa,CAAC;YAElD,IAAI,CAAC,oBAAoB,EAAE;gBACzB,kFAAkF;gBAClF,0GAA0G;gBAC1G,IAAI,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;;aAErC;YAED,KAAgC,UAAgC,EAAhC,KAAA,kBAAkB,CAAC,aAAa,EAAhC,cAAgC,EAAhC,IAAgC,EAAE;gBAA7D,IAAI,mBAAmB,SAAA;gBAC1B,2FAA2F;gBAC3F,IAAI,CAAC,oBAAoB,EAAE,mBAAmB,CAAC,CAAC;aACjD;YAED,IAAI,oBAAoB,CAAC,MAAM,IAAI,CAAC,EAAE;gBACpC,+FAA+F;gBAC/F,IAAI,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;aACrC;;QA3BH,KAAqB,UAA2B,EAA3B,KAAA,mBAAmB,CAAC,KAAK,EAAE,EAA3B,cAA2B,EAA3B,IAA2B;YAA3C,IAAI,QAAQ,SAAA;oBAAR,QAAQ;SA4BhB;QAED,IAAI,mBAAmB,CAAC,MAAM,GAAG,CAAC,EAAE;YAClC,IAAI,CAAC,oBAAoB,CAAC,SAAS,EAAE,mBAAmB,EAAE,UAAA,QAAQ;gBAChE,IAAI,QAAQ,EAAE;oBACZ,WAAW,EAAE,CAAC;iBACf;YACH,CAAC,CAAC,CAAC;SACJ;aAAM;YACL,WAAW,EAAE,CAAC;SACf;IACH,CAAC;IAED,iDAAoB,GAApB,UAAqB,SAAS,EAAE,WAAW,EAAE,QAAQ;QAArD,iBAgFC;QA/EC,IAAI,MAAM,GAAQ,EAAE,CAAC;QACrB,MAAM,CAAC,SAAS,GAAG,SAAS,CAAC;QAC7B,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC;QACjC,MAAM,CAAC,iBAAiB,GAAG,IAAI,CAAC,+BAA+B,CAC7D,WAAW,EACX,SAAS,CACV,CAAC;QACF,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;QAE9B,MAAM,CAAC,QAAQ,GAAG,UAAA,QAAQ;YACxB,IAAI,QAAQ,EAAE;wCACH,UAAU;oBACjB,IAAI,kBAAkB,GAAG,SAAS,CAAC,WAAW,CAAC,IAAI,CACjD,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,IAAI,IAAI,UAAU,CAAC,IAAI,EAAjC,CAAiC,CAC/C,CAAC;oBACF,IAAI,CAAC,kBAAkB,EAAE;wBACvB,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;qBACxC;yBAAM;wBACL,sEAAsE;wBACtE,IAAI,YAAY,GAAG,kBAAkB,CAAC,aAAa,IAAI,EAAE,CAAC;wBAC1D,kBAAkB,CAAC,aAAa,GAAG,IAAI,CACrC,YAAY,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,CAAC,CAC9C,CAAC;qBACH;;gBAZH,KAAuB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW;oBAA7B,IAAI,UAAU,oBAAA;4BAAV,UAAU;iBAalB;gBACD,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;gBAChD,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;aACzB;YAED,KAAI,CAAC,iBAAiB,GAAG,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,UAAA,aAAa;gBAClE,cAAc;gBACd,IAAI,aAAa,IAAI,MAAM,EAAE;oBAC3B,aAAa,CAAC,WAAW,IAAI,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;oBACjE,OAAO,KAAK,CAAC;iBACd;gBAED,IAAM,oBAAoB,GAAG,UAAS,MAAM,EAAE,MAAM;oBAClD,OAAO,CAAC,MAAM,CAAC,IAAI,CACjB,UAAA,GAAG;wBACD,OAAA,CAAC,MAAM,CAAC,IAAI,CACV,UAAA,SAAS,IAAI,OAAA,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAjD,CAAiD,CAC/D;oBAFD,CAEC,CACJ,CAAC;gBACJ,CAAC,CAAC;gBAEF,IAAI,aAAa,CAAC,SAAS,IAAI,SAAS,EAAE;oBACxC,qGAAqG;oBACrG,IACE,aAAa,CAAC,WAAW,IAAI,WAAW;wBACxC,oBAAoB,CAAC,WAAW,EAAE,aAAa,CAAC,WAAW,CAAC,EAC5D;wBACA,iHAAiH;wBACjH,+BAA+B;wBAC/B,IAAI,QAAQ,EAAE;4BACZ,aAAa,CAAC,WAAW,IAAI,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;yBAClE;wBACD,OAAO,KAAK,CAAC;qBACd;iBACF;gBACD,OAAO,IAAI,CAAC;YACd,CAAC,CAAC,CAAC;YAEH,IAAI,KAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrC,KAAI,CAAC,wBAAwB,CAAC,KAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;aAC1D;QACH,CAAC,CAAC;QAEF,yKAAyK;QACzK,IAAI,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAChD,SAAS,EAAE,SAAS;SACrB,CAAC,CAAC;QAEH,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAEpC,IAAI,CAAC,cAAc,EAAE;YACnB,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,CAAC;SACvC;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;SACjD;IACH,CAAC;IAED,qDAAwB,GAAxB,UAAyB,MAAM;QAC7B,OAAO,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;IACjC,CAAC;IAED,+CAAkB,GAAlB,UAAmB,SAAS;QAC1B,OAAO,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;IACjC,CAAC;IAED,4CAAe,GAAf,UAAgB,OAAO;QACrB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC9B,CAAC;IAED,8CAAiB,GAAjB,UAAkB,UAAU;QAC1B,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;QAC9D,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,CAAC,GAAG,CAAC,+CAA+C,CAAC,CAAC;YAC7D,OAAO;SACR;QACD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1D,CAAC;IAED,iDAAiD;IAC3C,oDAAuB,GAA7B,UAA8B,SAAS,EAAE,eAAe;;;;;;wBACtD,IAAI,SAAS,CAAC,MAAM,KAAK,eAAe,EAAE;4BACxC,IAAI,IAAI,CAAC,cAAc,EAAE;gCACvB,OAAO,CAAC,GAAG,CACT,sBAAsB,EACtB,kDAAkD,CACnD,CAAC;6BACH;yBACF;wBAED,IAAI,IAAI,CAAC,cAAc,EAAE;4BACvB,OAAO,CAAC,GAAG,CAAC,8CAA8C,EAAE,SAAS,CAAC,CAAC;yBACxE;wBACD,SAAS,CAAC,MAAM,GAAG,eAAe,CAAC;wBACnC,KAAA,SAAS,CAAA;wBAAc,qBAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE,EAAA;;wBAA5D,GAAU,UAAU,GAAG,SAAqC,CAAC;wBAC7D,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE;4BACrC,MAAM,EAAE,sBAAsB;4BAC9B,UAAU,EAAE,SAAS,CAAC,UAAU;4BAChC,aAAa,EAAE,SAAS,CAAC,aAAa;4BACtC,IAAI,EAAE;gCACJ,IAAI,EAAE,SAAS,CAAC,IAAI;gCACpB,WAAW,EAAE,IAAI,CAAC,WAAW;gCAC7B,QAAQ,EAAE,IAAI,CAAC,QAAQ;gCACvB,eAAe,EAAE,IAAI,CAAC,mBAAmB,EAAE;6BAC5C;yBACF,CAAC,CAAC;wBAEH,IAAI,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;wBAE5C,IAAI,IAAI,CAAC,cAAc,EAAE;4BACvB,IAAI,CAAC,cAAc,CAAC,yBAAyB,CAAC,SAAS,CAAC,CAAC;yBAC1D;;;;;KACF;IAED,8CAAiB,GAAjB,UAAkB,SAAS,EAAE,QAAgB;QAAhB,yBAAA,EAAA,gBAAgB;QAC3C,IAAI,SAAS,GAAG,SAAS,CAAC,MAAM,IAAI,IAAI,CAAC;QAEzC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;gCACf,OAAO;YACd,IACE,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC;gBACtC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC3B;gBACA,6GAA6G;gBAC7G,2FAA2F;gBAC3F,8HAA8H;gBAC9H,+HAA+H;gBAC/H,8IAA8I;gBAC9I,OAAK,SAAS,CAAC;oBACb,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBACpE,CAAC,CAAC,CAAC;aACJ;;;QAbH,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa;YAA5B,IAAI,OAAO,SAAA;oBAAP,OAAO;SAcf;QAED,IAAI,SAAS,IAAI,CAAC,QAAQ,EAAE;YAC1B,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAChD,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;SACzB;QAED,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;YAC9C,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACvC;QAED,IAAI,SAAS,CAAC,IAAI,IAAI,QAAQ,EAAE;YAC9B,IAAI,CAAC,+BAA+B,EAAE,CAAC;SACxC;IACH,CAAC;IAED,gDAAmB,GAAnB,UAAoB,SAAS,EAAE,QAAgB;QAAhB,yBAAA,EAAA,gBAAgB;QAC7C,IAAI,SAAS,GAAG,SAAS,CAAC,MAAM,IAAI,KAAK,CAAC;QAC1C,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;QACzB,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC;gCAEnB,OAAO;YACd,IACE,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC;gBACtC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC3B;gBACA,wEAAwE;gBACxE,OAAK,SAAS,CAAC;oBACb,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBACpE,CAAC,CAAC,CAAC;aACJ;;;QATH,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa;YAA5B,IAAI,OAAO,SAAA;oBAAP,OAAO;SAUf;QAED,IAAI,SAAS,IAAI,CAAC,QAAQ,EAAE;YAC1B,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAChD,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;SACzB;QAED,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;QAEvC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,UAAA,CAAC;YAClD,OAAO,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAA,CAAC;YAChE,OAAO,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,SAAS,CAAC,IAAI,IAAI,QAAQ,EAAE;YAC9B,IAAI,CAAC,+BAA+B,EAAE,CAAC;SACxC;IACH,CAAC;IAEK,4CAAe,GAArB,UAAsB,SAAS;;;;;gBAC7B,EAAE;gBACF,qBAAqB;gBACrB,EAAE;gBACF,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;oCAEhB,OAAO;oBACd,IACE,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC;wBACtC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC3B;wBACA,wEAAwE;wBACxE,OAAK,SAAS,CAAC;4BACb,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;wBACpE,CAAC,CAAC,CAAC;qBACJ;;;gBATH,WAAiC,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa;oBAAxB,OAAO;4BAAP,OAAO;iBAUf;gBAED,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,UAAA,CAAC;oBAClD,OAAO,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC;gBACnC,CAAC,CAAC,CAAC;gBAEH,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAA,CAAC;oBAChE,OAAO,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC;gBACnC,CAAC,CAAC,CAAC;gBAEH,IAAI,SAAS,CAAC,IAAI,IAAI,QAAQ,EAAE;oBAC9B,IAAI,CAAC,+BAA+B,EAAE,CAAC;iBACxC;gBAED,EAAE;gBACF,mBAAmB;gBACnB,EAAE;gBAEF,sBAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;wBACjC,KAAI,CAAC,QAAQ,CAAC;4BACZ,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;4BACxB,KAAoB,UAAa,EAAb,KAAA,KAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;gCAA9B,IAAI,OAAO,SAAA;gCACd,IACE,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC;oCACtC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAC3B;oCACA,wEAAwE;oCACxE,KAAI,CAAC,SAAS,CAAC;wCACb,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;wCAClE,OAAO,EAAE,CAAC;oCACZ,CAAC,CAAC,CAAC;iCACJ;6BACF;4BAED,IAAI,CAAC,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;gCAC9C,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;6BACvC;4BAED,IAAI,SAAS,CAAC,IAAI,IAAI,QAAQ,EAAE;gCAC9B,KAAI,CAAC,+BAA+B,EAAE,CAAC;6BACxC;4BACD,iEAAiE;4BACjE,kEAAkE;4BAClE,OAAO,EAAE,CAAC;wBACZ,CAAC,CAAC,CAAC;oBACL,CAAC,CAAC,EAAC;;;KACJ;IAED,4CAAe,GAAf,UAAgB,SAAS;QACvB,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;QAChD,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;IAC1B,CAAC;IAED,8CAAiB,GAAjB,UAAkB,SAAS;QACzB,OAAO,SAAS,CAAC,MAAM,CAAC;IAC1B,CAAC;IAED,+CAAkB,GAAlB,UAAmB,SAAS;QAC1B,KAAkB,UAAmD,EAAnD,KAAA,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,EAAnD,cAAmD,EAAnD,IAAmD,EAAE;YAAlE,IAAI,KAAK,SAAA;YACZ,IAAI,WAAW,GAAG,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC;YAC5C,IAAI,WAAW,KAAK,SAAS,CAAC,IAAI,EAAE;gBAClC,OAAO,KAAK,CAAC;aACd;SACF;IACH,CAAC;IAED,qDAAwB,GAAxB,UAAyB,SAAS;QAChC,IAAI,OAAO,GAAG,QAAQ,CAAC,aAAa,IAAI,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;QAC3E,KAAoB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA9B,IAAI,OAAO,SAAA;YACd,wEAAwE;YACxE,OAAO,CAAC,YAAY,IAAI,OAAO,CAAC,YAAY,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SAClE;IACH,CAAC;IAED,+CAAkB,GAAlB,UAAmB,SAAS,EAAE,IAAI;QAChC,IAAI,OAAO,GAAG,UAAC,OAAO,EAAE,IAAI;YAC1B,IAAI,WAAW,GACb,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAI,IAAI,CAAC,KAAK,OAAI,CAAC;YAClE,IAAI,YAAY,GACd,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAI,IAAI,CAAC,MAAM,OAAI,CAAC;YACrE,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,YAAY,CAClB,OAAO,EACP,WAAS,WAAW,iBAAY,YAAY,MAAG,CAChD,CAAC;aACH;QACH,CAAC,CAAC;QAEF,IAAI,SAAS,CAAC,IAAI,IAAI,OAAO,IAAI,SAAS,CAAC,IAAI,IAAI,OAAO,EAAE;YAC1D,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC;YAC7D,IAAI,OAAO,GAAG,QAAQ,CAAC,cAAc,CACnC,uBAAqB,QAAQ,SAAI,SAAS,CAAC,IAAM,CAClD,CAAC;YACF,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;aACxB;SACF;aAAM;YACL,IAAI,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAChD,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO;aACR;YAED,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAEtB,wGAAwG;YACxG,iHAAiH;YACjH,sFAAsF;YACtF,IAAI,SAAS,CAAC,IAAI,IAAI,cAAc,EAAE;gBACpC,IAAI,QAAM,GAAG,MAAM,CAAC,aAAa,CAAC;gBAClC,IAAI,QAAM,EAAE;oBACV,OAAO,CAAC,QAAM,EAAE,IAAI,CAAC,CAAC;iBACvB;aACF;YAED,kFAAkF;YAClF,iGAAiG;YACjG,+EAA+E;YAC/E,wDAAwD;YACxD,gBAAgB;YAChB,4BAA4B;YAC5B,IAAI;SACL;IACH,CAAC;IAED,0CAAa,GAAb,UAAc,IAAI;QAChB,IAAI,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,CAAC;QACtD,KAAmB,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAO,EAAE;YAAvB,IAAI,MAAM,gBAAA;YACb,IAAI,MAAM,CAAC,0BAA0B,CAAC,IAAI,CAAC,EAAE;gBAC3C,OAAO,MAAM,CAAC;aACf;SACF;QAED,sFAAsF;QACtF,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,wBAAwB,EAAE;gBAC1C,OAAO,IAAI,CAAC,gBAAgB,EAAE,CAAC;aAChC;SACF;aAAM;YACL,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,EAAE;gBAC9C,OAAO,OAAO,CAAC,MAAM,CAAC,UAAA,CAAC;oBACrB,OAAO,CAAC,CAAC,eAAe,EAAE,CAAC;gBAC7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACP;SACF;IACH,CAAC;IACD,6CAAgB,GAAhB;QACE,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAED,4DAA+B,GAA/B,UAAgC,WAAW,EAAE,SAAS;QAAtD,iBA+DC;QA9DC,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,IAAI,gBAAgB,GAAG,WAAW,CAAC,MAAM,CAAC;QAE1C,IAAI,YAAY,GAAG,UAAC,KAAK,EAAE,MAAM;YAC/B,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,IAAI,KAAK,IAAI,MAAM,GAAG,CAAC,EAAE;oBACvB,IAAI,MAAM,IAAI,CAAC,EAAE;wBACf,OAAO,OAAO,CAAC;qBAChB;yBAAM;wBACL,OAAO,QAAQ,CAAC;qBACjB;iBACF;qBAAM;oBACL,OAAO,IAAI,CAAC;iBACb;aACF;YAED,OAAO,EAAE,CAAC;QACZ,CAAC,CAAC;QAEF,WAAW,CAAC,OAAO,CAAC,UAAC,UAAU,EAAE,KAAK;YACpC,IAAI,UAAU,CAAC,IAAI,KAAK,cAAc,EAAE;gBACtC,IAAI,KAAK,GAAG,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,UAAA,IAAI;oBAC3C,IAAI,IAAI,GAAG,KAAI,CAAC,YAAY,CAAC,kCAAkC,CAAC,IAAI,CAAC,CAAC;oBACtE,IAAI,IAAI,EAAE;wBACR,OAAO,IAAI,GAAG,GAAG,CAAC;qBACnB;yBAAM;wBACL,OAAO,gBAAgB,GAAG,IAAI,CAAC;qBAChC;gBACH,CAAC,CAAC,CAAC;gBACH,IAAI,WAAW,GAAG,EAAE,CAAC;gBAErB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACrC,IAAI,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;oBACpB,WAAW,IAAI,YAAY,CACzB,CAAC,EACD,KAAK,CAAC,MAAM,GAAG,gBAAgB,GAAG,KAAK,GAAG,CAAC,CAC5C,CAAC;oBACF,WAAW,IAAI,IAAI,CAAC;iBACrB;gBAED,WAAW,IAAI,YAAY,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;gBAErD,WAAW,IAAI,WAAW,CAAC;gBAE3B,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,IAAI,KAAK,GAAG,gBAAgB,GAAG,CAAC,EAAE;oBACrD,oGAAoG;oBACpG,WAAW,IAAI,IAAI,CAAC;iBACrB;aACF;iBAAM,IAAI,UAAU,CAAC,IAAI,KAAK,qBAAqB,EAAE;gBACpD,IAAI,OAAO,GAAG;oBACZ,cAAc,EAAE,cAAc;oBAC9B,WAAW,EAAE,cAAc;oBAC3B,eAAe,EAAE,cAAc;iBAChC,CAAC;gBAEF,WAAW,IAAI,YAAY,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;gBAErD,WAAW,IAAI,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;aACxC;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,WAAW,GAAG,GAAG,CAAC;IAC3B,CAAC;IAh/CD,+DAA+D;IACxD,mCAAgB,GAAG,iCAAiC,CAAC;IAg/C9D,yBAAC;CAAA,AArgDD,IAqgDC;SArgDY,kBAAkB\"}","dts":{"name":"/Users/daj/personal/projects/standard-notes/snjs/dist/types/services/componentManager.d.ts","writeByteOrderMark":false,"text":"import { StandardFile } from 'standard-file-js/lib/standard_file';\r\nexport declare class SNComponentManager {\r\n    $uiRunner: any;\r\n    $timeout: any;\r\n    modelManager: any;\r\n    syncManager: any;\r\n    desktopManager: any;\r\n    nativeExtManager: any;\r\n    alertManager: any;\r\n    streamObservers: any[];\r\n    contextStreamObservers: any[];\r\n    activeComponents: any[];\r\n    environment: any;\r\n    platform: any;\r\n    isDesktop: boolean;\r\n    isMobile: boolean;\r\n    permissionDialogs: any[];\r\n    handlers: any[];\r\n    loggingEnabled: any;\r\n    SFJS: StandardFile;\r\n    static ClientDataDomain: string;\r\n    constructor({ modelManager, syncManager, desktopManager, nativeExtManager, alertManager, $uiRunner, $timeout, environment, platform }: {\r\n        modelManager: any;\r\n        syncManager: any;\r\n        desktopManager: any;\r\n        nativeExtManager: any;\r\n        alertManager: any;\r\n        $uiRunner: any;\r\n        $timeout: any;\r\n        environment: any;\r\n        platform: any;\r\n    });\r\n    configureForGeneralUsage(): void;\r\n    configureForNonMobileUsage(): void;\r\n    postActiveThemesToAllComponents(): void;\r\n    getActiveThemes(): any;\r\n    urlsForActiveThemes(): any;\r\n    postActiveThemesToComponent(component: any): void;\r\n    contextItemDidChangeInArea(area: any): void;\r\n    setComponentHidden(component: any, hidden: any): void;\r\n    jsonForItem(item: any, component: any, source?: any): any;\r\n    sendItemsInReply(component: any, items: any, message: any, source?: any): void;\r\n    sendContextItemInReply(component: any, item: any, originalMessage: any, source?: any): void;\r\n    replyToMessage(component: any, originalMessage: any, replyData: any): void;\r\n    sendMessageToComponent(component: any, message: any): void;\r\n    readonly components: any;\r\n    componentsForArea(area: any): any;\r\n    urlForComponent(component: any, offlinePrefix?: string): any;\r\n    componentForUrl(url: any): any;\r\n    componentForSessionKey(key: any): any;\r\n    handleMessage(component: any, message: any): void;\r\n    removePrivatePropertiesFromResponseItems(responseItems: any, component: any, options?: any): void;\r\n    handleStreamItemsMessage(component: any, message: any): void;\r\n    handleStreamContextItemMessage(component: any, message: any): void;\r\n    isItemIdWithinComponentContextJurisdiction(uuid: any, component: any): boolean;\r\n    itemIdsInContextJurisdictionForComponent(component: any): any[];\r\n    handlersForArea(area: any): any[];\r\n    handleSaveItemsMessage(component: any, message: any): Promise<void>;\r\n    handleDuplicateItemMessage(component: any, message: any): void;\r\n    handleCreateItemsMessage(component: any, message: any): void;\r\n    handleDeleteItemsMessage(component: any, message: any): void;\r\n    handleRequestPermissionsMessage(component: any, message: any): void;\r\n    handleSetComponentDataMessage(component: any, message: any): void;\r\n    handleToggleComponentMessage(sourceComponent: any, targetComponent: any, message: any): void;\r\n    toggleComponent(component: any): void;\r\n    handleInstallLocalComponentMessage(sourceComponent: any, message: any): void;\r\n    runWithPermissions(component: any, requiredPermissions: any, runFunction: any): void;\r\n    promptForPermissions(component: any, permissions: any, callback: any): void;\r\n    presentPermissionsDialog(dialog: any): void;\r\n    openModalComponent(component: any): void;\r\n    registerHandler(handler: any): void;\r\n    deregisterHandler(identifier: any): void;\r\n    registerComponentWindow(component: any, componentWindow: any): Promise<void>;\r\n    activateComponent(component: any, dontSync?: boolean): void;\r\n    deactivateComponent(component: any, dontSync?: boolean): void;\r\n    reloadComponent(component: any): Promise<unknown>;\r\n    deleteComponent(component: any): void;\r\n    isComponentActive(component: any): any;\r\n    iframeForComponent(component: any): HTMLIFrameElement | undefined;\r\n    focusChangedForComponent(component: any): void;\r\n    handleSetSizeEvent(component: any, data: any): void;\r\n    editorForNote(note: any): any;\r\n    getDefaultEditor(): void;\r\n    permissionsStringForPermissions(permissions: any, component: any): string;\r\n}\r\n"}}
